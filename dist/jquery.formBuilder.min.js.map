{"version":3,"file":"jquery.formBuilder.min.js","sources":["../src/util/util.js","../src/plugins/caret.js","../src/widgets/formBuilder.js","../src/widgets/inputField.js","../src/widgets/inputFilter.js","../src/widgets/popOver.js","../src/widgets/submitButton.js","../src/types/code.js","../src/types/select.js","../src/types/standard.js"],"names":["window","util","$","console","log","dir","timeStamp","time","timeEnd","Object","create","o","F","prototype","lang","code","selectPath","namespace","domKey","undefined","i","a","toString","split","length","key","match","parseInt","isArray","insertPath","obj","type","origRef","types","k","v","push","deletePath","fn","childOf","b","includeSelf","jQuery","this","p","parents","isEmpty","equals","hasOwnProperty","removeEqual","ignoreDiffKeys","remove","removeTmp","inArray","widget","options","lines","width","radius","rotate","color","speed","trail","shadow","hwaccel","className","zIndex","top","left","_spinner","_create","self","Spinner","_init","start","spin","element","stop","_destroy","caret","begin","end","range","input","is","l","val","setSelectionRange","selectionStart","selectionEnd","document","selection","createRange","duplicate","moveStart","text","focus","value","scrollLeft","err","createTextRange","collapse","moveEnd","select","converter","fromForm","data","toForm","ignoreHidden","e","baseData","defaultRequired","fieldsWidgets","fields","scanForNewFields","dirty","on","ev","stopPropagation","isDirty","show","find","each","el","attr","Error","has","add","label","addClass","wrap","before","not","newInput","inputField","require","_proxyCommandToWidget","widgetElement","widgetName","instance","method","Array","splice","call","arguments","args","slice","apply","clearDirty","flashDirty","numberOfTimes","flashError","filter","error","disable","enable","get","formData","_readDataFromDom","isFunction","clear","conflicts","ignoreKeys","_convertFormData","aData","extend","bData","conflict","concat","set","setOptions","_trigger","_writeDataToDom","values","validate","valid","getFields","repeat","work","delay","count","idx","setTimeout","statusNames","loadDomData","aKey","flash","placeholder","min","max","empty","tooltip","tooltipContent","next","field","layers","items","setLabel","appendTo","trim","removeAttr","preinput","addOn","postinput","suffix","setSuffix","prefix","setPrefix","addon","popOver","target","onShow","onHide","removeClass","one","autoValidate","states","updateStatus","status","blur","_onBlur","change","_onKeyup","suffixShim","_onKeydown","mouseenter","mouseleave","setType","prevValue","setMax","prependTo","html","t","inputFilter","toUpper","pattern","_showLayer","checkDirty","redraw","cleanCheckTimer","clearTimeout","prev","isEmptyObject","trigger","weight","pre","found","children","hasClass","eWeight","insertBefore","append","s","hide","vOld","vNew","vDirty","autoClean","hasStatus","_formatToField","f","_clean","_formatFromField","skipRequired","setError","message","clearError","format","flashTimer","toField","fromField","hasVal","showError","showNotice","showPlaceholder","css","paddingLeft","startPaddingLeft","startInputWidth","prefixPaddingAdded","replace","isNaN","outerWidth","paddingRight","startPaddingRight","suffixPaddingAdded","valWidth","maxWidth","layer","ph","sType","add123","tearDown","setUp","getType","displayValue","getField","isDisabled","statusName","bool","fireEvents","cleanBool","height","outerHeight","ui","memory","nativeChange","proxy","_onKeyDown","_onKeyPress","_onPaste","setPattern","regex","which","ctrlKey","_type","String","fromCharCode","c","tmp","keytypedEvent","keyignoredEvent","toUpperCase","substring","off","doc","win","showing","detach","content","clone","title","onClick","delegateTarget","activeElement","onResize","position","setAppendTo","titleElement","toggle","fadeIn","my","at","collision","of","disabled","waiting","preventDefault","enterKeyListenerProvider","first","onKeyDown","keyCode","submit","_showLoading","h","getButtonLabel","spinner","_hideLoading","destroyed","bOptions","icons","button","listenerProvider","listener","binarySearch","needle","haystack","mid","high","low","toLowerCase","codeListFilter","codeTable","request","response","term","matcher","RegExp","autocomplete","escapeRegex","matches","grep","test","codeTableName","_codeTable","source","inputWidget","fieldGroup","shim","insertAfter","iconClosed","iconOpen","panel","selectionClass","sectionClass","_setSelected","after","parent","_keyDownNavigate","closeListener","close","update","selected","_scroll","open","filterValue","_filterOptions","_selectFirstNonEmptyOption","item","_setLabel","renderLabel","showHideCommand","_removeSelection","option","_set","loaded","done","itemData","_equal","_handleItemNotFound","_setDefaultItem","_selectFirstItem","defaultValue","showClass","sections","showHideSections","_getLabel","getOptions","optionPanel","filterTimer","__filterOptionsWork","optionsElements","optionsToProcessNow","optionsEl","_filterItem","optionEl","_itemShoudBeFiltered","_clearFilter","_buildEmptyOption","emptyLabel","unshift","_buildOptions","optionsbuffer","_sort","renderedItem","renderItem","sort","al","bl","scrollTop","inputLayer","itemsLayer","leftOffset","index","Deferred","load","removeInvalid","form","resolve","id","dataOptions","parseJSON","when","map","raw","deMap","rawdata","cannedFormatters","createRegexType","flags","filterData","cannedFormatter","utext","integer","number","state","feid","zip","email","display","phone","extensionStart","xlocation","indexOf","lastSpace","lastIndexOf","ext","extraExt","num","numberLength","money","_onChange","dec","parseFloat","toFixed","date","minYear","Date","getFullYear","maxYear","datePickerOptions","onSelect","dateText","inst","showOn","changeMonth","changeYear","yearRange","datepicker","regional","datePickerDiv","click","moment","isValid","dateTime","fieldWidget","utc","local","invalidMessage","es","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix"],"mappings":"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","sourcesContent":["/*\n * A subset of the ADD Utility library. \n *\n * It only declares objects/functions when they do not already exist\n */\n\nif(typeof(window.util) === 'undefined')\n\twindow.util = {};\n\n(function($) {\n\t\"use strict\";\n\n\t/*\n\t * If console is not defined build a mock console to avoid script errors in production\n\t */\n\tif(typeof(window.console) === 'undefined') {\n\t\twindow.console = {\n\t\t\tlog: function() {},\n\t\t\tdir: function() {},\n\t\t\ttimeStamp: function () {},\n\t\t\ttime: function () {},\n\t\t\ttimeEnd: function () {}\n\t\t};\n\t}\n\n\tif(typeof(console.timeStamp) === 'undefined'){\n\t\tconsole.timeStamp = function () {};\n\t}\n\tif(typeof(console.time) === 'undefined'){\n\t\tconsole.time = function () {};\n\t}\n\tif(typeof(console.timeEnd) === 'undefined'){\n\t\tconsole.timeEnd = function () {};\n\t}\n\n\n\t/*\n\t * Object create polyfill\n\t */\n\tif(typeof(Object.create) === 'undefined') {\n\t\tObject.create = function(o) {\n\t\t\tfunction F() {}\n\t\t\tF.prototype = o;\n\t\t\treturn new F();\n\t\t};\n\t}\n\n\n\n\t/*\n\t * supported language codes\n\t */\n\tvar langCodes = {\n\t\t'en': 'English',\n\t\t'es': 'Español',\n\t\t'fr': 'Français'\n\t};\n\t\n\tif(typeof(util.lang) === 'undefined')\n\t\tutil.lang = {};\n\t\n\tif(typeof(util.lang.code) === 'undefined')\n\t\tutil.lang.code = 'en'; //default\n\n\t/*\n\t * Retrieve from a namespace given the dot-notated key\n\t *\n\t * Since the form has a flat structure and therefore has prefixes to avoid naming conflicts, we need a way to map\n\t * the prefixed DOM Keys to the hierarchical data maps. Keys that are not found will be saved in the extraKeys object\n\t * in the correct hierarchical order\n\t *\n\t * DOM -> Data Examples: given dealFile = efsResponse['efs']['deal-file']\n\t *\n\t * basic:\n\t *   'deal.acquired-date' -> dealFile['deal']['acquired-date']\n\t *   'purchase-vehicle.data.vin' -> dealFile['purchase-vehicle']['data']['vin']\n\t *\n\t * arrays:\n\t *   'customer.0.first-name' -> dealFile['customer'][0]['first-name']\n\t *\n\t */\n\n\tif(typeof(util.selectPath) === 'undefined') {\n\t\tutil.selectPath = function(namespace, domKey) {\n\t\t\t\n\t\t\tif(namespace === undefined){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(domKey === undefined || domKey === ''){\n\t\t\t\treturn namespace;\n\t\t\t}\n\n\t\t\tvar i, a = domKey.toString().split('.');\n\t\t\tfor(i = 0; i < a.length; i += 1) {\n\t\t\t\tvar key = a[i];\n\t\t\t\tif(key.match(/^[0-9]{1,3}$/)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * treat this as an array index\n\t\t\t\t\t */\n\t\t\t\t\tkey = parseInt(key, 10);\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * arrays with index might be pulled out of the array, so check if we can find the correct mapping without the array\n\t\t\t\t */\n\t\t\t\tif(key === 0 && !$.isArray(namespace)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif(namespace === undefined || namespace === null) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tnamespace = namespace[key];\n\n\t\t\t\tif(i === a.length - 1 || namespace === undefined) {\n\t\t\t\t\treturn namespace;\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t}\n\n\t/*\n\t * Given and namespace object and a dot-notated key, save the given object to\n\t * the proper path in the namespace\n\t *\n\t */\n\tif(typeof(util.insertPath) === 'undefined') {\n\t\tutil.insertPath = function(namespace, domKey, obj) {\n\t\t\tvar i, a = domKey.split('.'),\n\t\t\t\torigRef = namespace;\n\t\t\tvar types = [],\n\t\t\t\tkey, type;\n\n\t\t\tfor(i = 0; i < a.length; i += 1) {\n\t\t\t\tkey = a[i];\n\n\t\t\t\tif(i === a.length - 1) {\n\n\t\t\t\t\t/*\n\t\t\t\t\t * clean this logic up, use this test case : https://secure.add123.com/apps/web/res/js/_test/qunit.html\n\t\t\t\t\t */\n\t\t\t\t\tif(key.match(/^[0-9]{1,3}$/)) {\n\n\t\t\t\t\t\ttypes[types.length - 1] = {\n\t\t\t\t\t\t\tk: types[types.length - 1].k,\n\t\t\t\t\t\t\tv: []\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\ttypes.push({\n\t\t\t\t\t\t\tk: parseInt(key, 10),\n\t\t\t\t\t\t\tv: obj\n\t\t\t\t\t\t});\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttypes.push({\n\t\t\t\t\t\t\tk: key,\n\t\t\t\t\t\t\tv: obj\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t} else if(key.match(/^[0-9]{1,3}$/)) {\n\n\t\t\t\t\ttypes[types.length - 1] = {\n\t\t\t\t\t\tk: types[types.length - 1].k,\n\t\t\t\t\t\tv: []\n\t\t\t\t\t};\n\n\t\t\t\t\ttypes.push({\n\t\t\t\t\t\tk: parseInt(key, 10),\n\t\t\t\t\t\tv: {}\n\t\t\t\t\t});\n\n\t\t\t\t} else {\n\t\t\t\t\ttypes.push({\n\t\t\t\t\t\tk: key,\n\t\t\t\t\t\tv: {}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(i = 0; i < types.length; i += 1) {\n\t\t\t\ttype = types[i];\n\t\t\t\tkey = type.k;\n\n\t\t\t\tif(i === a.length - 1) {\n\t\t\t\t\tnamespace[key] = type.v;\n\t\t\t\t} else {\n\n\t\t\t\t\tif(typeof namespace[key] === 'undefined') {\n\t\t\t\t\t\tnamespace[key] = type.v;\n\t\t\t\t\t}\n\n\t\t\t\t\tnamespace = namespace[key];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn origRef;\n\n\t\t};\n\t}\n\n\t/*\n\t * var ns = {test: {foo: 1, bar: 2, baz: 3}};\n\t * deletePath(ns, 'test.foo');\n\t * console.log(ns);\n\t *\n\t * TODO: make this work for arrays\n\t */\n\tif(typeof(util.deletePath) === 'undefined') {\n\t\tutil.deletePath = function(namespace, domKey) {\n\t\t\tvar a = domKey.split('.'),\n\t\t\t\ti;\n\t\t\tfor(i = 0; i < a.length; i += 1) {\n\t\t\t\tif(i === a.length - 1) {\n\t\t\t\t\tdelete namespace[a[i]];\n\t\t\t\t} else {\n\t\t\t\t\tif(typeof namespace[a[i]] === \"undefined\") {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tnamespace = namespace[a[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\n\t/*\n\t * parameter can be a jQuery object or HTML element object\n\t */\n\tif(typeof($.fn.childOf) === 'undefined') {\n\t\t$.fn.childOf = function(b, includeSelf) {\n\t\t\tvar i;\n\n\t\t\tif(b instanceof jQuery) {\n\t\t\t\tb = b[0];\n\t\t\t}\n\n\t\t\tif(includeSelf && b === this[0]) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar p = this.parents();\n\t\t\tfor(i = 0; i < p.length; i++) {\n\t\t\t\tif(b === p[i]) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n\n\tif(typeof(window.isEmpty) === 'undefined') {\n\t\twindow.isEmpty = function isEmpty(a) {\n\t\t\tif(a === 0){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn !a;\n\t\t};\n\t}\n\n\tif(typeof(util.equals) === 'undefined') {\n\t\tutil.equals = function(a, b) {\n\t\t\tvar p;\n\n\t\t\tif(a === b){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(isEmpty(a) && isEmpty(b)){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(isEmpty(a) || isEmpty(b)){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tswitch(typeof(a)) {\n\t\t\tcase 'object':\n\t\t\t\tfor(p in a) {\n\t\t\t\t\tif(a.hasOwnProperty(p)) {\n\t\t\t\t\t\tif(!util.equals(a[p], b[p])) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(p in b) {\n\t\t\t\t\tif(b.hasOwnProperty(p)) {\n\t\t\t\t\t\tif(!util.equals(a[p], b[p])) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tbreak;\n\t\t\tcase 'function':\n\t\t\t\tif(typeof(b) === 'undefined' || (a.toString() !== b.toString())) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(a.toString() !== b.toString()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t};\n\t}\n\n\tif(typeof(util.removeEqual) === 'undefined') {\n\t\tutil.removeEqual = function (a, b, ignoreDiffKeys) {\n\t\t\tvar p, remove, removeTmp;\n\n\t\t\tif(!ignoreDiffKeys){\n\t\t\t\tignoreDiffKeys = [];\n\t\t\t}\n\n\t\t\tif(a === undefined || b === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch(typeof(a)) {\n\t\t\tcase 'object':\n\t\t\t\tremove = true;\n\t\t\t\tfor(p in a) {\n\t\t\t\t\tif(a.hasOwnProperty(p)) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($.inArray(p, ignoreDiffKeys) > -1){\n\t\t\t\t\t\t\tremoveTmp = true;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tremoveTmp = util.removeEqual(a[p], b[p]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(removeTmp){\n\t\t\t\t\t\t\tdelete a[p];\n\t\t\t\t\t\t\tdelete b[p];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tremove = remove && removeTmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn remove;\n\t\t\tdefault:\n\t\t\t\treturn a.toString() === b.toString();\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * jQuery UI Widget support for spin.js\n\t *\n\t * http://fgnass.github.com/spin.js/\n\t */\n\t$.widget('add123.spin', {\n\n\t\toptions: {\n\t\t\tlines: 10,\n\t\t\t// The number of lines to draw\n\t\t\tlength: 4,\n\t\t\t// The length of each line\n\t\t\twidth: 2,\n\t\t\t// The line thickness\n\t\t\tradius: 3,\n\t\t\t// The radius of the inner circle\n\t\t\trotate: 0,\n\t\t\t// The rotation offset\n\t\t\tcolor: '#000',\n\t\t\t// #rgb or #rrggbb\n\t\t\tspeed: 1.5,\n\t\t\t// Rounds per second\n\t\t\ttrail: 60,\n\t\t\t// Afterglow percentage\n\t\t\tshadow: false,\n\t\t\t// Whether to render a shadow\n\t\t\thwaccel: false,\n\t\t\t// Whether to use hardware acceleration\n\t\t\tclassName: 'spinner',\n\t\t\t// The CSS class to assign to the spinner\n\t\t\tzIndex: 0,\n\t\t\t// The z-index (defaults to 2000000000)\n\t\t\ttop: '0',\n\t\t\t// Top position relative to parent in px\n\t\t\tleft: '0' // Left position relative to parent in px\n\t\t},\n\n\t\t_spinner: undefined,\n\n\t\t_create: function() {\n\t\t\tvar self = this;\n\t\t\tself._spinner = new Spinner(self.options);\n\t\t},\n\n\t\t_init: function() {\n\t\t\tthis.start();\n\t\t},\n\n\t\tstart: function() {\n\t\t\tthis._spinner.spin(this.element[0]);\n\t\t},\n\n\t\tstop: function() {\n\t\t\tthis._spinner.stop();\n\t\t},\n\n\t\t_destroy: function() {\n\t\t\tvar self = this;\n\t\t\tself.stop();\n\t\t\tdelete self._spinner;\n\t\t}\n\t});\n\n})(jQuery);\n","/**\n * caret plugin\n */\n\n(function($){\n\t/*\n\t * This plugin only operates on the first element of the working set\n\t */\n\t$.fn.caret = function(begin, end) {\n\n\t\tif(this.length === 0) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar input = this[0],\n\t\t\trange;\n\n\t\tif(typeof begin === 'number') {\n\t\t\t/*\n\t\t\t * setter mode\n\t\t\t */\n\n\t\t\tif(!$(input).is(':visible')) {\n\t\t\t\treturn input;\n\t\t\t}\n\n\t\t\tend = (typeof end === 'number') ? end : begin;\n\n\t\t\tif(input.setSelectionRange) {\n\t\t\t\tinput.focus();\n\t\t\t\tinput.setSelectionRange(begin, end);\n\t\t\t\t\n\t\t\t\t/*\n\t\t\t\t * chrome hack\n\t\t\t\t * TMS-2049\n\t\t\t\t * Still need a better way to do this, chrome fails to set the scrolLeft\n\t\t\t\t * whem the cursor moves, still will only work it they are at the end of the text\n\t\t\t\t */\n\t\t\t\ttry{\n\t\t\t\t\tif(end === input.value.length){\n\t\t\t\t\t\tinput.scrollLeft = 9999999999;\n\t\t\t\t\t}\n\t\t\t\t}catch(err){}\n\t\t\t} else if(input.createTextRange) {\n\t\t\t\trange = input.createTextRange();\n\t\t\t\trange.collapse(true);\n\t\t\t\trange.moveEnd('character', end);\n\t\t\t\trange.moveStart('character', begin);\n\t\t\t\trange.select();\n\t\t\t}\n\n\n\t\t} else {\n\t\t\t/*\n\t\t\t * getter mode\n\t\t\t */\n\n\t\t\tif(!$(input).is(':visible')) {\n\t\t\t\tvar l = $(input).val().length;\n\t\t\t\treturn {\n\t\t\t\t\tbegin: l,\n\t\t\t\t\tend: l\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif(input.setSelectionRange) {\n\t\t\tbegin = input.selectionStart;\n\t\t\t\tend = input.selectionEnd;\n\t\t\t} else if(document.selection && document.selection.createRange) {\n\t\t\t\trange = document.selection.createRange();\n\t\t\t\tbegin = -range.duplicate().moveStart('character', -100000);\n\t\t\t\tend = begin + range.text.length;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbegin: begin,\n\t\t\t\tend: end\n\t\t\t};\n\t\t}\n\n\t\treturn input;\n\t};\n})(jQuery);","/**\n * formBuilder Widget\n *\n * TODO: improve codes type\n *\n * TODO: handle submission, bind to buttons somehow, and on-submit event\n *\n * TODO: maintain a model, take in the model, link to the fields and make is\n * accessible by a getter model linker? listen to changes\n *\n * TODO: can you call _init() a second type with more options? is that how you\n * call _setOption from outside?\n */\n\n(function($) {\n\t\"use strict\";\n\n\t$.widget(\"add123.formBuilder\", {\n\n\t\toptions: {\n\t\t\tconverter: {\n\t\t\t\tfromForm: function(data) {\n\t\t\t\t\treturn data;\n\t\t\t\t},\n\t\t\t\ttoForm: function(data) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/*\n\t\t\t * set to true to ignore fields that are not $(':visible')\n\t\t\t */\n\t\t\tignoreHidden: false\n\t\t},\n\n\t\t_create: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element;\n\n\t\t\tself.baseData = {};\n\n\t\t\to.defaultRequired = e.data('default-required');\n\n\t\t\tself.fieldsWidgets = $([]);\n\t\t\tself.fields = $([]);\n\n\t\t\tself.scanForNewFields();\n\n\t\t\tself.dirty = false;\n\n\t\t\t/*\n\t\t\t * proxy the dirty events from all of the fields in the form\n\t\t\t */\n\t\t\te.on('dirty', function (ev) {\n\t\t\t\tif(self.dirty){\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tself.dirty = true;\n\t\t\t}).on('clean', function (ev) {\n\n\t\t\t\t/*\n\t\t\t\t * if the form is clean kill the clean event\n\t\t\t\t */\n\t\t\t\tif(!self.dirty){\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * check if form is really clean\n\t\t\t\t */\n\t\t\t\tself.dirty = self.isDirty();\n\n\t\t\t\t/*\n\t\t\t\t * if form is still dirty, kill the clean event\n\t\t\t\t */\n\t\t\t\tif(self.dirty){\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\te.show();\n\t\t},\n\n\t\tscanForNewFields: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element;\n\n\t\t\t/*\n\t\t\t * expected methods for a widget to act a as field:\n\t\t\t *\n\t\t\t * set()\n\t\t\t * get()\n\t\t\t * isDirty()\n\t\t\t * clearDirty()\n\t\t\t * flashDirty()\n\t\t\t * flashError()\n\t\t\t * disable()\n\t\t\t * enable()\n\t\t\t * clear()\n\t\t\t * validate()\n\t\t\t *\n\t\t\t */\n\t\t\te.find('[data-load-widget-as-field]').each(function () {\n\t\t\t\tvar el = $(this);\n\t\t\t\tif(!el.attr('name')){\n\t\t\t\t\tthrow new Error('data-load-widget-as-field must have name attribute');\n\t\t\t\t}\n\n\t\t\t\tif(self.fieldsWidgets.has(el[0]).length){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tel[el.attr('data-load-widget-as-field')]();\n\n\t\t\t\t/*\n\t\t\t\t * check if the widget extends the base FieldWidget widget\n\t\t\t\t */\n\n\t\t\t\tself.fieldsWidgets = self.fieldsWidgets.add(el);\n\n\t\t\t\t/*\n\t\t\t\t * wrap if label is found\n\t\t\t\t */\n\t\t\t\tvar label = el.attr('data-label');\n\n\t\t\t\tif(!label){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tel.addClass('field-items').wrap('<div class=\"input-field-group\"><div class=\"input-field\"></div></div>').before('<label>' + label + '</label>');\n\t\t\t});\n\t\t\t/*\n\t\t\tself.fields = e.find('input[type!=submit], select, textarea').not(':add123-inputField').inputField({\n\t\t\t\trequire: typeof o.defaultRequired !== 'undefined' && o.defaultRequired === true\n\t\t\t});\n\t\t\t*/\n\t\t\te.find('input[type!=submit], select, textarea').not(':add123-inputField').not('.form-builder-ignore *').each(function () {\n\t\t\t\tvar newInput = $(this);\n\t\t\t\tif(newInput.is('[data-load-widget-as-field]') || newInput.parents('[data-load-widget-as-field]').length){\n\t\t\t\t\t//console.log('ingnore input in field widgets: ', newInput.attr('name'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//console.log('ADDING FIELD: ', newInput.attr('name'));\n\t\t\t\tnewInput.inputField({\n\t\t\t\t\trequire: !!o.defaultRequired\n\t\t\t\t});\n\n\t\t\t\tself.fields = self.fields.add(newInput);\n\n\n\t\t\t});\n\n\n\n\t\t\t/*\n\t\t\t * set the first class on the first fields for proper styling\n\t\t\t */\n\t\t\t//setTimeout(function() {\n\t\t\t\t//var ingroup = e.find('.input-field-group .input-field .field-item:nth(0)').addClass('first');\n\t\t\t\t//\n\t\t\t\te.find('.input-field-group').each(function () {\n\t\t\t\t\t$(this).find('.field-item:first').addClass('first');\n\t\t\t\t});\n\t\t\t\t//console.log(ingroup);\n\t\t\t\t//e.find('.input-field .field-item:first-child').not('.input-field-group .input-field:first-child .field-item:first-child').addClass('first');\n\t\t\t//}, 0);\n\t\t},\n\n\t\t_proxyCommandToWidget: function (widgetElement) {\n\t\t\tvar self = this,\n\t\t\t\twidgetName = widgetElement.data('load-widget-as-field') || 'inputField',\n\t\t\t\tinstance = widgetElement.data(widgetName),\n\t\t\t\tmethod = Array.prototype.splice.call(arguments, 1, 1),\n\t\t\t\targs = Array.prototype.slice.call(arguments, 1);\n\n\t\t\ttry {\n\t\t\t\treturn instance[method].apply(instance, args);\n\t\t\t}catch(err){\n\t\t\t\tthrow new Error('ERROR: widget field error NAME[' + widgetName + '] METHOD[' + method + ']');\n\t\t\t}\n\t\t},\n\t\n\n\t\tisDirty: function() {\n\t\t\tvar self = this,\n\t\t\t\tdirty = false;\n\n\t\t\tself.fields.each(function() {\n\t\t\t\tdirty = !!$(this).inputField('isDirty');\n\t\t\t\treturn !dirty;\n\t\t\t});\n\n\t\t\tif(dirty){\n\t\t\t\treturn dirty;\n\t\t\t}\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tdirty = !!self._proxyCommandToWidget($(this), 'isDirty');\n\t\t\t\treturn !dirty;\n\t\t\t});\n\n\t\t\treturn dirty;\n\t\t},\n\n\t\tclearDirty: function() {\n\t\t\tvar self = this;\n\t\t\tself.dirty = false;\n\n\t\t\tself.fields.each(function() {\n\t\t\t\t$(this).inputField('clearDirty');\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tself._proxyCommandToWidget($(this), 'clearDirty');\n\t\t\t});\n\t\t},\n\n\t\tflashDirty: function(numberOfTimes) {\n\t\t\t//this.dirty.inputField('flash', numberOfTimes);\n\t\t\t/*\n\t\t\tvar self = this;\n\t\t\tself.dirty.each(function () {\n\t\t\t\tself._proxyCommandToWidget($(this), 'flash', numberOfTimes);\n\t\t\t});\n\t\t\t*/\n\t\t},\n\n\t\tflashError: function(numberOfTimes) {\n\t\t\tthis.fields.filter(function() {\n\t\t\t\treturn $(this).data('inputField').options.error;\n\t\t\t}).inputField('flash', numberOfTimes);\n\t\t},\n\n\t\tdisable: function() {\n\t\t\tthis.fields.inputField('status', 'disable', true);\n\t\t},\n\n\t\tenable: function() {\n\t\t\tthis.fields.inputField('status', 'disable', false);\n\t\t},\n\n\t\tget: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\tformData = self._readDataFromDom();\n\n\t\t\tif($.isFunction(o.converter.fromForm)) {\n\t\t\t\tformData = o.converter.fromForm(formData);\n\t\t\t}\n\n\t\t\tif(!formData){\n\t\t\t\tformData = {};\n\t\t\t}\n\n\t\t\treturn formData;\n\t\t},\n\n\t\tclear: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options;\n\n\t\t\tself.baseData = {};\n\n\t\t\tself.fields.each(function() {\n\t\t\t\t$(this).inputField('clear');\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tself._proxyCommandToWidget($(this), 'clear');\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * check if the given data would overwrite any dirty fields if set\n\t\t *\n\t\t * returns an array of conflict data, and false for no conflicts\n\t\t */\n\t\tconflicts: function (data, ignoreKeys) {\n\t\t\tvar self = this,\n\t\t\t\tformData = self._convertFormData(data),\n\t\t\t\tconflicts = [];\n\n\t\t\t/*\n\t\t\t * if dirty flag is not set, assume there is no conflict\n\t\t\t */\n\t\t\tif(!self.isDirty()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar aData = $.extend(true, {}, self.baseData),\n\t\t\t\tbData = $.extend(true, {}, formData);\n\n\t\t\tconsole.log('aData', aData);\n\t\t\tconsole.log('bData', bData);\n\n\t\t\t/*\n\t\t\t * only check fields that are different than the base value\n\t\t\t */\n\t\t\tutil.removeEqual(aData, bData, ignoreKeys);\n\n\t\t\tconsole.log('changes from base:', aData);\n\n\t\t\tself.fields.each(function() {\n\t\t\t\tvar conflict = $(this).inputField('conflicts', formData);\n\t\t\t\tif(conflict){\n\t\t\t\t\tconflicts.push(conflict);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tvar conflict = self._proxyCommandToWidget($(this), 'conflicts', formData);\n\t\t\t\tif(conflict){\n\t\t\t\t\tif($.isArray(conflict)){\n\t\t\t\t\t\tconflicts.concat(conflict);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconflicts.push(conflict);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(conflicts.length){\n\t\t\t\treturn conflicts;\n\t\t\t}else{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tset: function(data, setOptions) {\n\t\t\tvar self = this,\n\t\t\t\tformData = self._convertFormData(data);\n\n\t\t\tself.baseData = formData;\n\n\t\t\tself._trigger('beforeset', null, formData);\n\t\t\tself._writeDataToDom(formData, setOptions);\n\t\t\tself._trigger('afterset', null, formData);\n\t\t},\n\n\t\t_convertFormData: function (data) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options;\n\n\t\t\t/*\n\t\t\t * clone data object so form can not change the original\n\t\t\t */\n\t\t\tvar formData = $.extend(true, {}, data || {});\n\n\t\t\tif($.isFunction(o.converter.toForm)) {\n\t\t\t\tformData = o.converter.toForm(formData);\n\t\t\t}\n\n\t\t\treturn formData;\n\t\t},\n\n\t\tval: function(values) {\n\t\t\t//TODO: forgot to implement this, there is logic taking its place in efsfl.js\n\t\t\tif(values === undefined) {\n\t\t\t\t/*\n\t\t\t\t * getter\n\t\t\t\t */\n\t\t\t\treturn {};\n\t\t\t} else {\n\t\t\t\t/*\n\t\t\t\t * setter\n\t\t\t\t */\n\t\t\t\treturn this;\n\t\t\t}\n\t\t},\n\n\t\tvalidate: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\tvalid = true;\n\n\t\t\tself.fields.each(function() {\n\t\t\t\tvar el = $(this);\n\t\t\t\tif(el.is(':visible') && el.inputField('validate') === false){\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tvar el = $(this);\n\t\t\t\tif(el.is(':visible') && self._proxyCommandToWidget(el, 'validate') === false){\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn valid;\n\t\t},\n\n\t\t_destroy: function() {\n\t\t\tvar self = this;\n\t\t\tself.fields.inputField('destroy');\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tself._proxyCommandToWidget($(this), 'destroy');\n\t\t\t});\n\t\t},\n\n\t\tgetFields: function() {\n\t\t\treturn this.fields;\n\t\t},\n\n\t\t_writeDataToDom: function(data, setOptions) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options;\n\n\t\t\tself.fields.each(function() {\n\t\t\t\t$(this).inputField('set', util.selectPath(data, $(this).attr('name')), setOptions);\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\t//debugger;\n\t\t\t\tself._proxyCommandToWidget($(this), 'set', util.selectPath(data, $(this).attr('name')), setOptions);\n\t\t\t});\n\t\t},\n\n\t\t_readDataFromDom: function() {\n\t\t\tvar self = this,\n\t\t\t\tignoreHidden = self.options.ignoreHidden,\n\t\t\t\tdata = {};\n\n\t\t\tself.fields.each(function() {\n\t\t\t\tvar el = $(this);\n\t\t\t\tif(ignoreHidden && !el.is(':visible')){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar val = el.inputField('get');\n\n\t\t\t\tif($.isArray(val)) {\n\t\t\t\t\tval = val[0];\n\t\t\t\t}\n\n\t\t\t\tutil.insertPath(data, el.attr('name'), val);\n\t\t\t});\n\n\t\t\tself.fieldsWidgets.each(function() {\n\t\t\t\tvar el = $(this),\n\t\t\t\t\tignoreHidden = self.options.ignoreHidden;\n\n\t\t\t\tif(ignoreHidden && !el.is(':visible')){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar val = self._proxyCommandToWidget(el, 'get');\n\t\t\t\tutil.insertPath(data, el.attr('name'), val);\n\t\t\t});\n\n\t\t\treturn data;\n\t\t}\n\t});\n\n\t\n\n}(jQuery));","/**\n * inputField Widget\n *\n * This widget wraps the operation of a single field of a form\n *\n * Public Methods:\n *   value(value)\n *   validate()\n *   flash()\n *   setError()\n *   clearError()\n *   redraw()\n *   status(statusName, bool)\n */\n(function($) {\n\t\"use strict\";\n\n\tvar repeat = function(work, delay, count, idx) {\n\t\tidx = idx || 0;\n\t\tif(idx < count) {\n\t\t\twork();\n\t\t\tsetTimeout(function() {\n\t\t\t\trepeat(work, delay, count, idx + 1);\n\t\t\t}, delay);\n\t\t}\n\t};\n\n\tvar statusNames = ['require', 'disable', 'error', 'hover', 'warn', 'focus'];\n\n\tvar loadDomData = function(namespace, aKey) {\n\t\tvar self = this;\n\t\t$.each(aKey, function(i, key) {\n\t\t\t/*\n\t\t\tif(namespace){\n\t\t\t\treturn;\n\t\t\t}*/\n\t\t\tvar data = self.element.data(key);\n\t\t\tif(data !== undefined && data !== null) {\n\t\t\t\tnamespace[key] = data;\n\t\t\t}\n\t\t});\n\t};\n\n\t$.widget('add123.fieldWidget', {\n\n\t\tisDirty: function () {\n\t\t\treturn false;\n\t\t},\n\n\t\tvalidate: function () {\n\t\t\treturn true;\n\t\t},\n\n\t\tclearDirty: function () {\n\t\t\t\n\t\t},\n\n\t\tclear: function () {\n\t\t\tthis.set();\n\t\t},\n\n\t\tflash: function () {\n\t\t\t\n\t\t},\n\n\t\tset: function (data) {\n\t\t\t\n\t\t},\n\n\t\tget: function () {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\t$.widget(\"add123.inputField\", {\n\t\toptions: {\n\n\t\t\ttype: 'text',\n\n\t\t\t/*\n\t\t\t * the text shown\n\t\t\t */\n\t\t\tlabel: '',\n\n\t\t\trequire: '',\n\n\t\t\t/*\n\t\t\t * text to show when the field is empty, this uses the suggest layer\n\t\t\t */\n\t\t\tplaceholder: '',\n\n\t\t\t/*\n\t\t\t * min and max, there meaning depends on the type that is loaded\n\t\t\t */\n\t\t\tmin: '', // min does nothing in formbuilder\n\t\t\tmax: ''\n\n\t\t\t/*\n\t\t\t * values: false/undefined, 'keyup', 'blur'\n\t\t\t */\n\t\t},\n\n\t\t_create: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element;\n\n\t\t\tif(!e.is('input[type!=submit], select, textarea')) {\n\t\t\t\tthrow new Error(\"invalid element\");\n\t\t\t}\n\n\t\t\tself.dirty = false;\n\n\t\t\t/*\n\t\t\t * load DOM settings from field into options\n\t\t\t */\n\t\t\tloadDomData.call(self, o, ['require', 'empty', 'placeholder', 'type', 'label', 'min', 'max', 'preinput', 'postinput', 'suffix', 'prefix']);\n\n\t\t\t/*\n\t\t\t * legacy support\n\t\t\t */\n\t\t\tif(!o.placeholder && o.empty) {\n\t\t\t\to.placeholder = o.empty;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * check if a tool-tip was given\n\t\t\t */\n\t\t\tvar tooltip, tooltipContent = e.next();\n\t\t\tif(tooltipContent.is('div.form-input-tooltip') || tooltipContent.is('div.tooltip')) {\n\t\t\t\ttooltip = tooltipContent;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * convert the simple input into the full field format\n\t\t\t */\n\t\t\tvar field = self.field = $('<div class=\"input-field\"><div class=\"field-items\"><span class=\"field-item field-item-input\"></span></div></div>');\n\n\t\t\tvar layers = self.layers = {\n\t\t\t\titems: field.find('.field-items'),\n\t\t\t\tinput: field.find('.field-item-input')\n\t\t\t};\n\n\t\t\tif(o.label){\n\t\t\t\tself.setLabel(o.label);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * move the DOM elements around\n\t\t\t */\n\t\t\te.before(field).appendTo(layers.input);\n\n\t\t\t/*\n\t\t\t * move classes\n\t\t\t */\n\t\t\tfield.attr('class', $.trim(field.attr('class') + ' ' + e.attr('class')));\n\t\t\te.removeAttr('class');\n\n\t\t\tif(e.is('textarea')) {\n\t\t\t\tfield.addClass('textarea-fix');\n\t\t\t\te.wrap('<div class=\"textarea-wrapper\"></div>');\n\t\t\t}\n\t\t\tif (e.is('select')) {\n\t\t\t\tfield.addClass('select-fix');\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * if this field is not part of a group, add a group class to this field for proper styling\n\t\t\t */\n\t\t\tif(!field.parents('.input-field-group').length){\n\t\t\t\tfield.wrap('<div class=\"input-field-group\"/>');\n\t\t\t\tfield.find('.field-item:first').addClass('first');\n\t\t\t}\n\n\t\t\tif(o.placeholder){\n\t\t\t\tself.placeholder(o.placeholder);\n\t\t\t}\n\n\t\t\tif(o.preinput) {\n\t\t\t\tself.addOn(-1, o.preinput);\n\t\t\t}\n\n\t\t\tif(o.postinput) {\n\t\t\t\tself.addOn(1, o.postinput);\n\t\t\t}\n\n\t\t\tif(o.suffix){\n\t\t\t\tself.setSuffix(o.suffix);\n\t\t\t}\n\n\t\t\tif(o.prefix){\n\t\t\t\tself.setPrefix(o.prefix);\n\t\t\t}\n\n\t\t\tif(tooltip) {\n\n\t\t\t\tvar addon = self.addOn(1000, '<span class=\"tooltip\">?</span>', 'clickable');\n\n\t\t\t\tfield.addClass('has-tooltip');\n\n\t\t\t\ttooltip.popOver({\n\t\t\t\t\ttarget: addon,\n\t\t\t\t\tonShow: function () {\n\t\t\t\t\t\taddon.addClass('open');\n\t\t\t\t\t},\n\t\t\t\t\tonHide: function () {\n\t\t\t\t\t\taddon.removeClass('open');\n\t\t\t\t\t}\n\t\t\t\t}).on('click', function () {\n\t\t\t\t\te.focus();\n\t\t\t\t});\n\n\n\n\t\t\t\ttooltip.popOver('hide');\n\n\n\t\t\t\taddon.on('click', function() {\n\t\t\t\t\ttooltip.popOver('toggle');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * move element style\n\t\t\t */\n\t\t\t// field.attr('style', e.attr('style'));\n\t\t\t// e.removeAttr('style');\n\t\t\t/*\n\t\t\t * add the pad1 class to make way for the drop down handle\n\t\t\t */\n\t\t\t// if(e.is('select')){\n\t\t\t// field.addClass('pad1');\n\t\t\t// }\n\t\t\t/*\n\t\t\t * if someone tries to select text from one of the layers, this will focus the input field\n\t\t\t */\n\t\t\t/* this causes problems when extra dialogs like dropdown panels are placed inside the field container */\n\t\t\t//field.on('mousedown.inputField', function() {\n\t\t\tlayers.input.on('mousedown.inputField', function() {\n\t\t\t\t$('body').one('mouseup.inputField', function() {\n\t\t\t\t\te.focus();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tself.autoValidate = 'blur';\n\n\t\t\tself.states = {};\n\n\t\t\t/*\n\t\t\t * set the require option as a status\n\t\t\t */\n\t\t\tself.updateStatus('require', o.require, false);\n\n\t\t\t/*\n\t\t\t * activate focus classes and suggestion layer\n\t\t\t */\n\t\t\te.focus(function() {\n\t\t\t\tself.status('focus', true);\n\t\t\t}).blur(function(ev) {\n\t\t\t\tself.status('focus', false);\n\t\t\t\tself._onBlur(ev);\n\t\t\t}).change(function(ev) {\n\t\t\t\tself._onKeyup(ev);\n\t\t\t}).on('inputfilterkeyignored.inputField', function() {\n\t\t\t\tself.flash();\n\t\t\t}).on('inputfilterkeytyped.inputField', function() {\n\t\t\t\tif(self.suffixShim){\n\t\t\t\t\tself.suffixShim.text(self.element.val());\n\t\t\t\t}\n\t\t\t}).on('keyup', function(ev) {\n\t\t\t\tself._onKeyup(ev);\n\t\t\t}).on('keydown', function(ev) {\n\t\t\t\tself._onKeydown(ev);\n\t\t\t});\n\n\t\t\tfield.mouseenter(function() {\n\t\t\t\tself.status('hover', true);\n\t\t\t}).mouseleave(function() {\n\t\t\t\tself.status('hover', false);\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * set the type of this field\n\t\t\t */\n\t\t\tself.setType(o.type);\n\n\t\t\tself.prevValue = e.val();\n\n\t\t\tif(o.max){\n\t\t\t\tself.setMax(o.max);\n\t\t\t}\n\t\t},\n\n\t\tsetLabel: function (label) {\n\t\t\tvar self = this,\n\t\t\t\tfield = self.field;\n\n\t\t\tif(!self.label){\n\t\t\t\tself.label = $('<label>' + label + '</label>');\n\t\t\t\tself.label.prependTo(field);\n\t\t\t}\n\n\t\t\tself.label.html(label);\n\t\t},\n\n\t\tsetSuffix: function (t) {\n\t\t\tvar self = this,\n\t\t\t\tlayers = self.layers;\n\n\t\t\tif(!layers.suffix){\n\t\t\t\tlayers.suffix = $('<div class=\"suffix-overlay\"><div class=\"shim\"></div><span class=\"value\">' + t + '</span></div>').prependTo(layers.items);\n\t\t\t\tself.suffixShim = layers.suffix.find('.shim');\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tlayers.suffix.find('.value').text(t);\n\t\t\t}\n\t\t},\n\n\t\tsetPrefix: function (t) {\n\t\t\tvar self = this,\n\t\t\t\tlayers = self.layers;\n\n\t\t\tif(!layers.prefix){\n\t\t\t\tlayers.prefix = $('<div class=\"prefix-overlay\">' + t + '</div>').prependTo(layers.items);\n\t\t\t}else{\n\t\t\t\tself.layers.prefix.find('.value').text(t);\n\t\t\t}\n\t\t},\n\n\t\tsetMax: function (max) {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tif(e.is(':add123-inputFilter')){\n\t\t\t\te.inputFilter('setMax', max);\n\t\t\t}else{\n\t\t\t\te.inputFilter({\n\t\t\t\t\ttoUpper: false,\n\t\t\t\t\tmax: max,\n\t\t\t\t\tpattern: /./\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t_onKeydown: function(ev) {\n\t\t\tvar self = this;\n\t\t\tself._showLayer('placeholder', false);\n\t\t},\n\n\t\t_onKeyup: function(ev) {\n\t\t\tvar self = this;\n\n\t\t\tif(self.autoValidate === 'keyup') {\n\t\t\t\t/*\n\t\t\t\t * defer validate, this will help give time for formaters and such to run\n\t\t\t\t */\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.validate(true);\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tself.checkDirty();\n\t\t\tself.redraw();\n\t\t},\n\n\t\tcheckDirty: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tval;\n\n\t\t\t//console.log('checkDirty', self.prevValue, self.get());\n\n\t\t\tif(!self.dirty){\n\t\t\t\tval = self.get();\n\n\t\t\t\t/*\n\t\t\t\t * TMS-350 Save/Cancel become greyed out on Ticket Details page even when changes are present\n\t\t\t\t */\n\t\t\t\tif(!util.equals(self.prevValue, val) && !(typeof self.prevValue === 'undefined' && val === '')){\n\t\t\t\t\te.trigger('dirty');\n\t\t\t\t\tself.dirty = true;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\t/*\n\t\t\t\t * clean checks can be fired many times, so debouce them with a timer\n\t\t\t\t */\n\t\t\t\tif(self.cleanCheckTimer){\n\t\t\t\t\tclearTimeout(self.cleanCheckTimer);\n\t\t\t\t}\n\t\t\t\tself.cleanCheckTimer = setTimeout(function() {\n\t\t\t\t\tvar prev = self.prevValue,\n\t\t\t\t\t\tval = self.get();\n\n\t\t\t\t\tif(prev !== 0 && (!prev || $.isEmptyObject(prev))){\n\t\t\t\t\t\tprev = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif(val !== 0 && (!val || $.isEmptyObject(val))){\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif(util.equals(prev,val)){\n\t\t\t\t\t\tself.dirty = false;\n\t\t\t\t\t\te.trigger('clean');\n\t\t\t\t\t\tself.redraw();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\n\t\tisDirty: function () {\n\t\t\treturn this.dirty;\n\t\t},\n\n\t\t_onBlur: function(ev) {\n\t\t\tvar self = this;\n\t\t\tif(self.autoValidate === 'blur') {\n\t\t\t\t/*\n\t\t\t\t * defer validate, this will help give time for formaters and such to run\n\t\t\t\t */\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.validate(true);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * weight < 0 goest to left\n\t\t *\n\t\t * Overly complex weight logic, maybe this can be refactored!\n\t\t */\n\t\taddOn: function(weight, html, className) {\n\t\t\tvar self = this,\n\t\t\t\tlayers = self.layers;\n\n\t\t\tif(typeof(weight) !== 'number') {\n\t\t\t\tweight = 0;\n\t\t\t}\n\n\t\t\tvar addon = $('<span data-weight=\"' + weight + '\" class=\"field-item addon\">' + html + '</span>');\n\n\t\t\tif(className) {\n\t\t\t\taddon.addClass(className);\n\t\t\t}\n\n\t\t\tvar pre = true, found = false;\n\t\t\tlayers.items.children().each(function () {\n\t\t\t\tvar el = $(this);\n\n\t\t\t\tif(el.hasClass('field-item-input')){\n\t\t\t\t\tpre = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Get correct element weight\n\t\t\t\tvar eWeight = el.data('weight');\n\t\t\t\tif(typeof(eWeight) !== 'number') {\n\t\t\t\t\teWeight = 0;\n\t\t\t\t}\n\n\t\t\t\tif(pre && weight < 0 && weight <= eWeight){\n\t\t\t\t\taddon.insertBefore(el);\n\t\t\t\t\tfound = true;\n\n\t\t\t\t\t// refresh first\n\t\t\t\t\tlayers.items.find('.field-item.first').not(':first').removeClass('first');\n\t\t\t\t\tlayers.items.find('.field-item').filter(':first').addClass('first');\n\n\t\t\t\t\treturn false;\n\t\t\t\t} else if(!pre && weight >= 0 && weight <= eWeight) {\n\t\t\t\t\taddon.insertBefore(el);\n\t\t\t\t\tfound = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(!found && weight < 0){\n\t\t\t\t// Must just left of input\n\t\t\t\tlayers.items.find('.field-item-input').before(addon);\n\t\t\t\t\n\t\t\t\t// refresh first\n\t\t\t\tlayers.items.find('.field-item.first').not(':first').removeClass('first');\n\t\t\t\tlayers.items.find('.field-item').filter(':first').addClass('first');\n\n\t\t\t} else if(!found){\n\t\t\t\t// Must go all the way right\n\t\t\t\tlayers.items.append(addon);\n\t\t\t}\n\n\t\t\treturn addon;\n\t\t},\n\n\t\tplaceholder: function (s) {\n\t\t\tvar self = this,\n\t\t\t\tlayers = self.layers;\n\n\t\t\tif(!layers.placeholder){\n\t\t\t\tlayers.placeholder = $('<div class=\"placeholder\"></div>').hide().appendTo(layers.input);\n\t\t\t}\n\n\t\t\tlayers.placeholder.text(s);\n\t\t},\n\n\t\t_init: function() {\n\t\t\tvar self = this;\n\t\t\tself.set(self.element.attr('value'));\n\t\t},\n\n\t\tclear: function () {\n\t\t\tvar self = this,\n\t\t\t\ttype = self.type;\n\n\t\t\tself.clearDirty();\n\n\t\t\tif(type && $.isFunction(type.clear)) {\n\t\t\t\ttype.clear.call(type, self);\n\t\t\t}else{\n\t\t\t\tself.prevValue = '';\n\t\t\t\tself.set('');\n\t\t\t}\n\t\t},\n\n\t\tclearDirty: function () {\n\t\t\tvar self = this;\n\n\t\t\tif(self.cleanCheckTimer){\n\t\t\t\tclearTimeout(self.cleanCheckTimer);\n\t\t\t}\n\n\t\t\tself.dirty = false;\n\t\t\tself.field.removeClass('dirty');\n\t\t\tself.element.trigger('clean');\n\t\t},\n\n\t\tconflicts: function (value) {\n\t\t\tvar self = this;\n\t\t\tif(self.dirty){\n\t\t\t\treturn {\n\t\t\t\t\tkey: self.element.attr('name'),\n\t\t\t\t\tvOld: self.prevValue,\n\t\t\t\t\tvNew: value,\n\t\t\t\t\tvDirty: self.get()\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tset: function(value, setOptions) {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tsetOptions = $.extend({autoClean: true}, setOptions);\n\n\t\t\tif (setOptions.autoClean) {\n\t\t\t\t/*\n\t\t\t\t * store the base value\n\t\t\t\t */\n\t\t\t\tself.prevValue = value;\n\n\t\t\t\tself.clearDirty();\n\t\t\t}\n\n\t\t\t// Remove error (only if needed to avoid a redraw)\n\t\t\tif(self.hasStatus('error'))\n\t\t\t\tself.status('error', false, false);\n\n\t\t\tvar val = self._formatToField(value);\n\n\t\t\t/*\n\t\t\t * some complex types might not want input.val() to be called,\n\t\t\t * so ignore all undefined variables\n\t\t\t */\n\t\t\tif(typeof(val) !== 'undefined') {\n\t\t\t\te.val(val);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * run the inputFilter if one exists on this field\n\t\t\t */\n\t\t\tvar f = e.data('inputFilter');\n\t\t\tif(f) {\n\t\t\t\tf._clean();\n\t\t\t}\n\n\t\t\tself._trigger('afterset', null, [val, value]);\n\t\t\t\n\t\t\tsetTimeout(function(){\n\t\t\t\tself.redraw();\n\t\t\t}, 0);\n\n\t\t},\n\t\t\n\n\t\tget: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\treturn self._formatFromField(e.val());\n\t\t},\n\n\t\t/*\n\t\t * Legacy Method, use get() and set()\n\t\t *\n\t\t * value getter/setter for this field\n\t\t */\n\t\tvalue: function(value) {\n\t\t\tvar self = this;\n\n\t\t\tif(value === undefined) {\n\t\t\t\treturn self.get();\n\t\t\t} else {\n\t\t\t\treturn self.set(value);\n\t\t\t}\n\t\t},\n\n\t\tvalidate: function(skipRequired) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element,\n\t\t\t\tstates = self.states,\n\t\t\t\ttype = self.type,\n\t\t\t\tempty;\n\n\n\t\t\t/*\n\t\t\t * check if type declares an isEmpty method\n\t\t\t */\n\t\t\tif($.isFunction(type.isEmpty)) {\n\t\t\t\tempty = type.isEmpty.call(type, self);\n\t\t\t}else{\n\t\t\t\tempty = $.trim(e.val()) === '';\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * check required, compare against the actual value in the field\n\t\t\t */\n\t\t\t\n\t\t\tif(!skipRequired && states.require && empty) {\n\t\t\t\tself.setError({\n\t\t\t\t\tmessage: 'required'\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * only call validate if not empty\n\t\t\t */\n\t\t\tif(empty) {\n\t\t\t\tself.clearError();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif($.isFunction(self.format)) {\n\t\t\t\tself.format.call(self);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * check the type validation\n\t\t\t */\n\t\t\tif($.isFunction(type.validate)) {\n\t\t\t\tvar err = type.validate.call(type, self);\n\t\t\t\tif(typeof err === 'undefined') {\n\t\t\t\t\tself.clearError();\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tself.setError(err);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tself.clearError();\n\t\t\treturn true;\n\t\t},\n\n\t\t/*\n\t\t * flashes the field to get the users attention\n\t\t *\n\t\t * TODO: support flashing patterns\n\t\t */\n\t\tflash: function(numberOfTimes) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options;\n\n\t\t\trepeat(function() {\n\t\t\t\tself.field.addClass('flash');\n\t\t\t\tself.flashTimer = setTimeout(function() {\n\t\t\t\t\tself.field.removeClass('flash');\n\t\t\t\t}, 150);\n\t\t\t}, 150, numberOfTimes || 1);\n\t\t},\n\n\t\t/*\n\t\t * err: {\n\t\t *   message: '',\n\t\t *   code: '',\n\t\t *   description: ''\n\t\t * }\n\t\t */\n\t\tsetError: function(err) {\n\t\t\tvar self = this,\n\t\t\t\terror = self.states.error,\n\t\t\t\tlayers = self.layers;\n\n\t\t\t/*\n\t\t\t * check if we need to clear the error\n\t\t\t */\n\t\t\tif(err === undefined) {\n\t\t\t\tself.clearError();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!layers.error) {\n\t\t\t\tlayers.error = $('<div class=\"error-overlay\"></div>').appendTo(layers.input);\n\t\t\t}\n\n\t\t\t//TODO: place error then check for overlaps\n\t\t\tlayers.error.text(err.message);\n\n\t\t\tself.status('error', true);\n\n\t\t\t/*\n\t\t\t * listen to keyUp events and rerun validate on this field\n\t\t\t */\n\t\t\tself.autoValidate = 'keyup';\n\t\t},\n\n\t\tclearError: function() {\n\t\t\tvar self = this;\n\n\t\t\tif(!self.states.error) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.autoValidate = 'blur';\n\t\t\tself.status('error', false);\n\t\t},\n\n\t\t_formatToField: function(value) {\n\t\t\tvar self = this,\n\t\t\t\ttype = self.type;\n\n\t\t\tif(value === null || value === undefined) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tif(!type || !type.converter || !$.isFunction(type.converter.toField)) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\treturn type.converter.toField.call(type, value, self);\n\t\t},\n\n\t\t_formatFromField: function(value) {\n\t\t\tvar self = this,\n\t\t\t\ttype = self.type;\n\n\t\t\tif(!type || !type.converter || !$.isFunction(type.converter.fromField)) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\treturn type.converter.fromField.call(type, value, self);\n\t\t},\n\n\t\t/*\n\t\t * decide what layers should be shown or hidden in the field\n\t\t *\n\t\t * warning: this function gets called a lot!\n\t\t */\n\t\tredraw: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\to = self.options,\n\t\t\t\thasVal = !!self.element.val(),\n\t\t\t\tshowError = false,\n\t\t\t\tshowNotice = true,\n\t\t\t\tshowPlaceholder = true,\n\t\t\t\tlayers = self.layers;\n\n\t\t\t\t//self.inputWidth = self.element.width(); // Added this line to fix display issue \n\n\t\t\tif(hasVal) {\n\t\t\t\tshowPlaceholder = false;\n\t\t\t}\n\n\t\t\tif(self.suffixShim && !showPlaceholder){\n\t\t\t\tself.suffixShim.text(e.val());\n\t\t\t}\n\n\t\t\tif(layers.prefix){\n\t\t\t\tif(!showPlaceholder) {\n\t\t\t\t\tif(!self.prefixPaddingAdded) {\n\t\t\t\t\t\tself.startInputWidth = e.width();\n\t\t\t\t\t\tself.startPaddingLeft = e.css('padding-left').replace('[^0-9]','');\n\t\t\t\t\t\tself.startPaddingLeft = isNaN(self.startPaddingLeft)? 5 : parseInt(self.startPaddingLeft);\n\t\t\t\t\t\te.css({\n\t\t\t\t\t\t\tpaddingLeft: (self.startPaddingLeft + layers.prefix.outerWidth()) + \"px\",\n\t\t\t\t\t\t\twidth: (self.startInputWidth - layers.prefix.outerWidth())  + 'px'\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tself.prefixPaddingAdded = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\te.css({\n\t\t\t\t\t\tpaddingLeft: self.startPaddingLeft,\n\t\t\t\t\t\twidth: self.startInputWidth + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tself.prefixPaddingAdded = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(layers.suffix){\n\t\t\t\tif(!showPlaceholder) {\n\t\t\t\t\tif(!self.suffixPaddingAdded) {\n\t\t\t\t\t\tvar valWidth = layers.suffix.find('.value').outerWidth();\n\n\t\t\t\t\t\tself.startInputWidth = e.width();\n\t\t\t\t\t\tself.startPaddingRight = e.css('padding-right').replace('[^0-9]','');\n\t\t\t\t\t\tself.startPaddingRight = isNaN(self.startPaddingRight)? 0 : parseInt(self.startPaddingRight);\n\n\t\t\t\t\t\te.css({\n\t\t\t\t\t\t\tpaddingRight: (self.startPaddingRight + valWidth) + 'px',\n\t\t\t\t\t\t\twidth: (self.startInputWidth - valWidth)  + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.suffixShim.css({\n\t\t\t\t\t\t\tmaxWidth: (self.startInputWidth - valWidth)  + 'px'\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tself.suffixPaddingAdded = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\t\n\t\t\t\t\te.css({\n\t\t\t\t\t\tpaddingRight: self.startPaddingRight,\n\t\t\t\t\t\twidth: self.startInputWidth + 'px'\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tself.suffixPaddingAdded = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\tif(o.hover){\n\n\t\t\t}\n\t\t\t*/\n\t\t\t/*\n\t\t\tif(o.focus){\n\t\t\t\tshowSuggest = false;\n\t\t\t}\n\t\t\t*/\n\t\t\t/*\n\t\t\tif(o.warn){\n\n\t\t\t}\n\t\t\t*/\n\t\t\tif(self.states.error) {\n\t\t\t\tshowNotice = false;\n\t\t\t\tshowError = true;\n\t\t\t}\n\n\t\t\tif(self.dirty){\n\t\t\t\tself.field.addClass('dirty');\n\t\t\t}else{\n\t\t\t\tself.field.removeClass('dirty');\n\t\t\t}\n\n\t\t\tself._showLayer('error', showError);\n\t\t\tself._showLayer('notice', showNotice);\n\t\t\tself._showLayer('placeholder', showPlaceholder);\n\t\t\tself._showLayer('suffix', !showPlaceholder);\n\t\t\tself._showLayer('prefix', !showPlaceholder);\n\t\t},\n\n\t\t_showLayer: function(layer, show) {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tif(!self.layers[layer]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(show) {\n\t\t\t\tif(layer === 'suffix')\n\t\t\t\t\tself.layers[layer].css('visibility', 'visible');\n\t\t\t\telse\n\t\t\t\t\tself.layers[layer].show();\n\n\t\t\t\t// MISC-919 make sure placeholder stays in input box\n\t\t\t\tif(layer === 'placeholder') {\n\t\t\t\t\tvar ph = self.layers[layer];\n\t\t\t\t\twhile(ph.outerWidth(true) > e.width()) {\n\t\t\t\t\t\tph.css('font-size','-=1');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(layer === 'suffix')\n\t\t\t\t\tself.layers[layer].css('visibility', 'hidden');\n\t\t\t\telse\n\t\t\t\t\tself.layers[layer].hide();\n\t\t\t}\n\t\t},\n\n\t\tsetType: function(sType) {\n\t\t\tvar self = this,\n\t\t\t\ttypes = $.add123.inputField.types,\n\t\t\t\ttype = self.type;\n\n\t\t\t/*\n\t\t\t * run the type tear down if it exists\n\t\t\t */\n\t\t\tif(type && $.isFunction(type.tearDown)) {\n\t\t\t\ttype.tearDown().call(type, self);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * if type doesn't exist set to the default of text\n\t\t\t */\n\t\t\tif(!sType || !types[sType]) {\n\t\t\t\tsType = 'text';\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * setup the field type\n\t\t\t */\n\t\t\ttype = Object.create(types[sType]);\n\n\t\t\t/*\n\t\t\t * run the type setup\n\t\t\t */\n\t\t\tif($.isFunction(type.setUp)) {\n\t\t\t\ttype.setUp.call(type, self);\n\t\t\t}\n\n\t\t\tself.type = type;\n\t\t},\n\n\t\t/*\n\t\t * returns the type object\n\t\t */\n\t\tgetType: function () {\n\t\t\treturn this.type;\n\t\t},\n\n\t\thide: function() {\n\t\t\tthis.field.hide();\n\t\t},\n\n\t\tshow: function(displayValue) {\n\t\t\tif (displayValue) {\n\t\t\t\tthis.field.css('display', displayValue);\n\t\t\t} else {\n\t\t\t\tthis.field.show();\n\t\t\t}\n\t\t},\n\n\t\tgetField: function() {\n\t\t\treturn this.field;\n\t\t},\n\n\t\tenable: function() {\n\t\t\tthis.status('disable', false);\n\t\t},\n\n\t\tdisable: function() {\n\t\t\tthis.status('disable', true);\n\t\t},\n\n\t\tisDisabled: function() {\n\t\t\treturn this.hasStatus('disable');\n\t\t},\n\n\t\t/*\n\t\t * public status setters\n\t\t */\n\t\tstatus: function(statusName, bool, fireEvents) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options;\n\n\t\t\t/*\n\t\t\t * only allow changes to status flags\n\t\t\t */\n\t\t\tif($.inArray(statusName, statusNames) < 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * clean and set status in options\n\t\t\t */\n\t\t\tvar cleanBool = !!bool,\n\t\t\t\tstates = self.states;\n\n\t\t\tif(cleanBool === states[statusName]) {\n\t\t\t\t/*\n\t\t\t\t * this status is already set, ignore\n\t\t\t\t */\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstates[statusName] = cleanBool;\n\t\t\tself.redraw();\n\n\t\t\t/*\n\t\t\t * set the status class to the field\n\t\t\t */\n\t\t\tif(states[statusName]) {\n\t\t\t\tself.field.addClass(statusName);\n\t\t\t} else {\n\t\t\t\tself.field.removeClass(statusName);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * run any updates to the field needed\n\t\t\t */\n\t\t\tvar layers = self.layers;\n\t\t\tif(statusName === 'disable') {\n\n\t\t\t\tif(!layers.disable) {\n\t\t\t\t\tlayers.disable = $('<div class=\"disable-overlay\"></div>').appendTo(layers.items);\n\t\t\t\t}\n\n\t\t\t\tif(cleanBool) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tlayers.disable.css({\n\t\t\t\t\t\t\twidth: (layers.items.outerWidth() - 2) + 'px',\n\t\t\t\t\t\t\theight: (layers.items.outerHeight() - 2) + 'px'\n\t\t\t\t\t\t}).show();\n\t\t\t\t\t}, 0);\n\n\t\t\t\t} else {\n\t\t\t\t\tlayers.disable.hide();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * fire statusUpdated event\n\t\t\t */\n\t\t\tif(fireEvents !== false) {\n\t\t\t\tself._trigger(\"statusUpdate\", null, {\n\t\t\t\t\t'statusName': statusName,\n\t\t\t\t\t'value': states[statusName]\n\t\t\t\t});\n\t\t\t}\n\n\t\t},\n\t\t/*\n\t\t * legacy status method\n\t\t */\n\t\tupdateStatus: function(statusName, bool, fireEvents) {\n\t\t\tthis.status(statusName, bool, fireEvents);\n\t\t},\n\n\t\thasStatus: function (statusName) {\n\t\t\treturn !!this.states[statusName];\n\t\t},\n\n\t\t_destroy: function () {\n\t\t\tvar self = this;\n\n\t\t\t//TODO remove all handlers\n\t\t\t//\n\n\t\t\t/*\n\t\t\t * tearDown type object\n\t\t\t */\n\t\t\tif(self.type && self.type.tearDown){\n\t\t\t\tself.type.tearDown.call(self.type, self);\n\t\t\t}\n\t\t}\n\t});\n\n\n\n\t$.add123.inputField.types = {\n\t\tsetUp: function(ui) {},\n\t\ttearDown: function(ui) {},\n\t\tconverter: {\n\t\t\ttoField: function(value, ui) {\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tfromField: function(value, ui) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\t\tvalidate: function(ui) {\n\t\t\treturn {\n\t\t\t\tmessage: 'Demo Error'\n\t\t\t};\n\t\t}\n\t};\n\n\n}(jQuery));\n\n","/**\n * inputFilter widget\n */\n\n(function($) {\n\t$.widget('add123.inputFilter', {\n\n\t\toptions: {\n\t\t\ttoUpper: false,\n\t\t\t//TODO: support max, flash when at end of string, other wise just splice off the end\n\t\t\tmax: 0,\n\t\t\tpattern: /[\\w\\s]/ \t// was [A-Z]\n\t\t},\n\n\t\t_create: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tmemory;\n\n\t\t\t/*\n\t\t\t * track if a native change event will be fired by the browser\n\t\t\t */\n\t\t\tself.nativeChange = false;\n\n\t\t\tif(!e.is('input[type=text], textarea')) {\n\t\t\t\tthrow new Error('inputFilter must be applied to a text input ');\n\t\t\t}\n\n\t\t\te.on('keydown.inputFilter', $.proxy(this._onKeyDown, self));\n\t\t\te.on('keypress.inputFilter', $.proxy(this._onKeyPress, self));\n\t\t\te.on('paste.inputFilter', $.proxy(this._onPaste, self));\n\n\t\t\t/*\n\t\t\t * support change events\n\t\t\t */\n\t\t\te.on('focus.inputFilter', function() {\n\t\t\t\tmemory = e.val();\n\t\t\t});\n\t\t\te.on('blur.inputFilter', function() {\n\t\t\t\tif(!self.nativeChange && memory !== e.val()) {\n\t\t\t\t\te.change();\n\t\t\t\t}\n\t\t\t\tself.nativeChange = false;\n\t\t\t});\n\n\t\t},\n\n\t\tsetMax: function (max) {\n\t\t\tthis.options.max = max;\n\t\t},\n\n\t\tsetPattern: function (regex) {\n\t\t\tthis.options.pattern = regex;\n\t\t},\n\n\t\t_onPaste: function(ev) {\n\t\t\t/*\n\t\t\t * on the paste event, schedule a clean\n\t\t\t */\n\t\t\tsetTimeout($.proxy(this._clean, this), 0);\n\t\t},\n\n\t\t_onKeyDown: function(ev) {\n\t\t\t/*\n\t\t\t * detect when the native change event will be fired\n\t\t\t */\n\t\t\tif(ev.which < 32 || ev.which > 126 || ev.ctrlKey) {\n\t\t\t\tthis.nativeChange = true;\n\t\t\t}\n\t\t},\n\n\n\t\t_onKeyPress: function(ev) {\n\t\t\tvar self = this;\n\t\t\t/*\n\t\t\t * Weird IE glitch fix\n\t\t\t *\n\t\t\t * TODO: this needs an explaination of the problem\n\t\t\t */\n\t\t\t//if (!ev.which && ((ev.charCode || ev.charCode === 0) ? ev.charCode : ev.keyCode)) {\n\t\t\t//\tev.which = ev.charCode || ev.keyCode;\n\t\t\t//}\n\t\t\t/*\n\t\t\t * bypass command keys\n\t\t\t */\n\t\t\tif(ev.which < 32 || ev.which > 126 || ev.ctrlKey) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tself._type(String.fromCharCode(ev.which));\n\t\t\treturn false;\n\t\t},\n\n\t\t/*\n\t\t * retype all the characters in the field so they are passed through the filter\n\t\t */\n\t\t_clean: function() {\n\t\t\tvar v = this.element.val();\n\t\t\tthis.element.val('');\n\t\t\t$.each(v.split(''), $.proxy(function(i, c) {\n\t\t\t\tthis._type(c);\n\t\t\t}, this));\n\t\t},\n\n\t\t/*\n\t\t * manually enter the given text into the input field\n\t\t * obeying the regular expression and triggering events\n\t\t * when characters are ignored\n\t\t */\n\t\t_type: function(text) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element,\n\t\t\t\tval = e.val(),\n\t\t\t\tkeytypedEvent = 'keytyped',\n\t\t\t\tkeyignoredEvent = 'keyignored',\n\t\t\t\tp, tmp;\n\n\t\t\tif(o.toUpper) {\n\t\t\t\ttext = text.toUpperCase();\n\t\t\t}\n\n\t\t\tif(text.match(o.pattern)) {\n\t\t\t\t/*\n\t\t\t\t * only deal with the caret if the field is focused\n\t\t\t\t */\n\t\t\t\tif(e.is(':focus')) {\n\t\t\t\t\tp = e.caret();\n\t\t\t\t\ttmp = val.slice(0, p.begin) + text + val.slice(p.end);\n\t\t\t\t\tif(o.max && tmp.length > o.max){\n\t\t\t\t\t\tself._trigger(keyignoredEvent);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}else{\n\t\t\t\t\t\te.val(tmp);\n\t\t\t\t\t\te.caret(p.begin + text.length);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tp = val + text;\n\n\t\t\t\t\tif(o.max && p.length > o.max){\n\t\t\t\t\t\tp = p.substring(0, o.max);\n\t\t\t\t\t\tself._trigger(keyignoredEvent);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\te.val(p);\n\t\t\t\t}\n\n\t\t\t\tself._trigger(keytypedEvent);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tself._trigger(keyignoredEvent);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\t_destroy: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\te.off('.inputFilter');\n\t\t}\n\n\t});\n})(jQuery);","\n\n(function($){\n\tvar doc = $(document),\n\t\twin = $(window),\n\t\tbody = $('body');\n\n\t$.widget(\"add123.popOver\", {\n\n\t\toptions: {\n\t\t\ttarget: '',\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tappendTo: 'body'\n\t\t},\n\n\t\t_create: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element;\n\n\t\t\tself.showing = false;\n\n\t\t\te.detach();\n\t\t\tvar content = e.clone().addClass('form-input-tooltip');\n\t\t\tself.title = $('<h3 class=\"tooltip-title\"></h3>');\n\n\t\t\te.addClass('tooltip-wrapper').css('position', 'absolute');\n\n\t\t\te.empty();\n\n\t\t\te.append(self.title).append(content);\n\n\t\t\te.appendTo(o.appendTo);\n\n\t\t\tself.onClick = function(ev) {\n\t\t\t\tvar target = $(ev.target);\n\n\t\t\t\tif(!self.showing){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!target.childOf(e, true) && !$(ev.delegateTarget.activeElement).childOf(e, true) && !target.childOf(o.target, true)) {\n\t\t\t\t\tif(self._trigger('beforeoffclick', ev, target)) {\n\t\t\t\t\t\tself.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tself.onResize = function(ev) {\n\t\t\t\tif(!self.showing){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tself.position();\n\t\t\t};\n\n\t\t\t/*\n\t\t\t * listen for off clicks\n\t\t\t */\n\t\t\tdoc.on('mousedown', self.onClick);\n\n\t\t\t/*\n\t\t\t * listen for window resizes\n\t\t\t */\n\t\t\twin.on('resize', self.onResize);\n\t\t},\n\n\t\tsetAppendTo: function (el) {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element;\n\n\t\t\to.appendTo = el;\n\t\t\te.appendTo(el);\n\t\t},\n\n\t\t_init: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\ttitleElement = self.title;\n\n\t\t\tvar title = e.attr('title');\n\n\t\t\tif(title) {\n\t\t\t\ttitleElement.text(title).show();\n\t\t\t}else{\n\t\t\t\ttitleElement.hide();\n\t\t\t}\n\t\t},\n\n\t\ttoggle: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tif(self.showing) {\n\t\t\t\tself.hide();\n\t\t\t} else {\n\t\t\t\tself.show();\n\t\t\t}\n\t\t},\n\n\t\tshow: function() {\n\t\t\tvar self = this;\n\n\t\t\tif(self.showing){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * show must be deferred with a timeout to avoid being affected by an offclick\n\t\t\t */\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.showing = true;\n\t\t\t\tself.position();\n\t\t\t\t/*\n\t\t\t\t * fadeIn is used instead of show() so that the popover\n\t\t\t\t * posistioning is not visible\n\t\t\t\t */\n\t\t\t\tself.element.fadeIn(10);\n\t\t\t\tself._trigger('onShow');\n\t\t\t}, 0);\n\t\t},\n\n\t\thide: function() {\n\t\t\tvar self = this;\n\n\t\t\tif(!self.showing){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.showing = false;\n\n\t\t\tself.element.hide();\n\t\t\tself._trigger('onHide');\n\t\t},\n\n\t\tposition: function() {\n\t\t\tvar self = this,\n\t\t\t\to = self.options,\n\t\t\t\te = self.element,\n\t\t\t\tmy = 'left+' + (o.left - 3) + ' top+' + (o.top + 3),\n\t\t\t\tat = 'left bottom',\n\t\t\t\tcollision = 'flipfit none';\n\n\t\t\tif (o.my) {\n\t\t\t\tmy = o.my;\n\t\t\t}\n\n\t\t\tif (o.at) {\n\t\t\t\tat = o.at;\n\t\t\t}\n\n\t\t\tif (o.collision) {\n\t\t\t\tcollision = o.collision;\n\t\t\t}\n\n\t\t\tsetTimeout(function() {\n\t\t\t\te.position({\n\t\t\t\t\tmy: my,\n\t\t\t\t\tat: at,\n\t\t\t\t\tof: o.target,\n\t\t\t\t\tcollision: collision\n\t\t\t\t});\n\t\t\t}, 0);\n\t\t},\n\n\t\t_destroy: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\tdoc.off('mousedown', self.onClick);\n\t\t\twin.off('resize', self.onResize);\n\t\t}\n\t});\n\n})(jQuery);","/**\n * submitButton Widget\n */\n(function($) {\n\t/*\n\t * when you catch the submitbuttonsubmit event, you need to call execute\n\t * 'event.data.onComplete' when the processing is done\n\t */\n\t$.widget('add123.submitButton', {\n\t\toptions: {\n\t\t\tcolor: '#000',\n\t\t\tdelay: 10,\n\t\t\tdisabled: false,\n\t\t\twaiting: false,\n\t\t\t// label: undefined, //ignored by create\n\t\t\tpreventDefault: true,\n\t\t\tenterKeyListenerProvider: function() {\n\t\t\t\treturn this.parents('form').first();\n\t\t\t},\n\t\t\tonKeyDown: function (ev) {\n\t\t\t\tif(ev.keyCode === 13 && !$(ev.target).is('textarea')) {\n\t\t\t\t\tthis.submit.call(this, ev);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_showLoading: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\to = self.options,\n\t\t\t\tw = e.width(),\n\t\t\t\th = e.height();\n\n\t\t\te.addClass('submitting');\n\n\t\t\tself.getButtonLabel().css('visibility', 'hidden');\n\n\t\t\tself.spinner.appendTo(e).spin({\n\t\t\t\tcolor: o.color,\n\t\t\t\ttop: -h + 4,\n\t\t\t\tleft: -7\n\t\t\t});\n\t\t},\n\n\t\tgetButtonLabel: function () {\n\t\t\treturn this.element.find('.ui-button-text');\n\t\t},\n\n\t\t_hideLoading: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tif(self.destroyed){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.removeClass('submitting');\n\t\t\tself.spinner.spin('stop');\n\t\t\tself.getButtonLabel().css('visibility', 'visible');\n\t\t},\n\n\t\t_create: function() {\n\t\t\tvar self = this;\n\t\t\tvar o = self.options;\n\t\t\tvar e = self.element,\n\t\t\t\tbOptions = {};\n\n\t\t\tif(o.icons) {\n\t\t\t\tbOptions.icons = o.icons;\t// does nothing\n\t\t\t}\n\n\t\t\tif(o.disabled) {\n\t\t\t\tbOptions.disabled = o.disabled;\n\t\t\t}\n\n\t\t\tif(o.text !== undefined){\n\t\t\t\tbOptions.text = o.text;\n\t\t\t}\n\n\t\t\to.label = e.html();\n\t\t\te.button(bOptions).on('click.submitButton', $.proxy(self.submit, self));\n\n\t\t\tself.spinner = $('<div class=\"spinner\" style=\"display: inline-block; position: absolute;\"></div>');\n\t\t\te.append(this.spinner);\n\n\t\t\t// This actually doesn't seem to do anything. The browser will do it automatically\n\t\t\tvar listenerProvider = o.enterKeyListenerProvider;\n\t\t\tif($.isFunction(listenerProvider)) {\n\t\t\t\tvar listener = listenerProvider.call(e);\n\t\t\t\tif(typeof listener !== 'undefined') {\n\t\t\t\t\tlistener.on('keydown.submitButton', $.proxy(o.onKeyDown, self));\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function(ev) {\n\t\t\tvar self = this;\n\t\t\tvar o = self.options;\n\n\t\t\tif(o.preventDefault && ev)\n\t\t\t\tev.preventDefault();\n\n\t\t\tif(o.waiting === true || o.disabled === true)\n\t\t\t\treturn this;\n\n\t\t\tif(!ev)\n\t\t\t\tev = null;\n\n\t\t\tif(self._trigger('beforesubmit', ev) === false)\n\t\t\t\treturn this;\n\n\n\t\t\to.waiting = true;\n\t\t\tself._showLoading.call(self);\n\n\t\t\t/*\n\t\t\t * submit clicks are delayed so that the UI can update before\n\t\t\t * doing all of the submit work\n\t\t\t *\n\t\t\t * passes the onComplete callback as the data for this event\n\t\t\t */\n\t\t\tsetTimeout(function() {\n\t\t\t\tself._trigger('submit', ev, function() {\n\t\t\t\t\to.waiting = false;\n\t\t\t\t\tself._hideLoading.call(self);\n\t\t\t\t\tself._trigger('aftersubmit', ev);\n\t\t\t\t});\n\t\t\t}, o.delay);\n\n\t\t\treturn this;\n\t\t},\n\n\t\tenable: function() {\n\t\t\tthis.options.disabled = false;\n\t\t},\n\n\t\tdisable: function() {\n\t\t\tthis.options.disabled = true;\n\t\t},\n\n\t\t_destroy: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\te.off('.submitButton');\n\t\t\tself.destroyed = true;\n\t\t}\n\t});\n})(jQuery);","/*\n\t * Large Code Type Support (code)\n\t *\n\t * TODO: update this so that the code table does not have to global (e.g. assigned to window)\n\t *\n\t * Example Code Table:\n\t * [\n\t *   {\"value\" : \"100\",  \"label\" : \"BROWARD TRAILER\"},\n\t *   {\"value\" : \"AAA\",  \"label\" : \"122 WELDING LLC. TRAILER\"},\n\t *   {\"value\" : \"BBB\",  \"label\" : \"22 WELDING LLC. TRAILER\"},\n\t *   {\"value\" : \"CCC\",  \"label\" : \"333 WELDING LLC. TRAILER\"},\n\t *   {\"value\" : \"EEE\",  \"label\" : \"444 WELDING LLC. TRAILER\"},\n\t *   {\"value\" : \"ZZZ\",  \"label\" : \"MEADOW CREEK WELDING LLC.\"}\n\t * ]\n\t */\n\n\n\n(function($) {\n\n\t/*\n\t * binary array search, codes must be in alpha order!\n\t */\n\tvar binarySearch = function(needle, haystack) {\n\t\tvar mid, element;\n\n\t\tif(!haystack.length) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tvar high = haystack.length - 1;\n\t\tvar low = 0;\n\n\t\tneedle = needle.toLowerCase();\n\n\t\t//TODO: only supporting case insensitive right now\n\t\twhile(low <= high) {\n\t\t\tmid = parseInt((low + high) / 2, 10);\n\t\t\telement = haystack[mid].value.toLowerCase();\n\t\t\tif(element > needle) {\n\t\t\t\thigh = mid - 1;\n\t\t\t} else if(element < needle) {\n\t\t\t\tlow = mid + 1;\n\t\t\t} else {\n\t\t\t\treturn mid;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\n\tvar codeListFilter = function(codeTable) {\n\t\treturn function(request, response) {\n\t\t\tif(request.term.length < 3) {\n\t\t\t\tresponse();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), \"i\");\n\n\t\t\tvar matches = $.grep(codeTable, function(value) {\n\t\t\t\treturn matcher.test(value.label) || matcher.test(value.value);\n\t\t\t});\n\n\t\t\tresponse(matches);\n\t\t};\n\t};\n\n\t$.add123.inputField.types.code = {\n\t\tsetUp: function(ui) {\n\t\t\tvar e = ui.element,\n\t\t\t\to = ui.options;\n\n\n\t\t\tvar codeTableName = e.data('codes');\n\n\t\t\tif(!codeTableName) {\n\t\t\t\tthrow new Error('not data-codes attribute given for input ' + e.attr('name'));\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * save code table reference to options\n\t\t\t */\n\t\t\to._codeTable = window[codeTableName];\n\n\t\t\tif(!o._codeTable) {\n\t\t\t\tthrow new Error('ERROR: data-codes points to an undefined window property window[' + codeTableName + '] for input [name=' + e.attr('name') + ']');\n\t\t\t}\n\n\t\t\te.autocomplete({\n\t\t\t\tsource: codeListFilter(o._codeTable)\n\t\t\t}).on('autocompleteselect.type-code', function(ev, ui) {\n\t\t\t\t/*\n\t\t\t\tif(ui.item && ui.item.label) {\n\t\t\t\t\t//o._layers.notice.html(ui.item.label).show();\n\t\t\t\t} else {\n\t\t\t\t\t//o._layers.notice.html('').hide(0);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}).on('keyup.type-code', function(ev) {\n\t\t\t\t/*\n\t\t\t\tvar val = binarySearch(e.val(), o._codeTable);\n\t\t\t\tif(val > -1) {\n\t\t\t\t\t//o._layers.notice.html(o._codeTable[val].label).show();\n\t\t\t\t} else {\n\t\t\t\t\t//o._layers.notice.html('').hide(0);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t});\n\n\t\t},\n\t\ttearDown: function(ui) {\n\t\t\tvar o = ui.options,\n\t\t\t\te = ui.element;\n\t\t\te.html('').off('.type-code').autocomplete('destroy');\n\t\t\tdelete o.codeTable;\n\t\t},\n\t\tvalidate: function(ui) {\n\t\t\tvar e = ui.element;\n\t\t\tif(binarySearch(e.val(), ui.options._codeTable) < 0) {\n\t\t\t\treturn {\n\t\t\t\t\tmessage: 'invalid'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t};\n\n})(jQuery);","/**\n * Datatype 'select'\n * \n */\n\n(function($) {\n\tvar doc = $(document);\n\t$.add123.inputField.types.select = {\n\t\tsetUp: function(inputWidget) {\n\t\t\tvar self = this,\n\t\t\t\to = inputWidget.options,\n\t\t\t\te = inputWidget.element;\n\n\t\t\tself.element = e;\n\t\t\tself.source = [];\n\t\t\tself.inputWidget = inputWidget;\n\n\t\t\tvar fieldGroup = self.fieldGroup = inputWidget.field.parents('.input-field-group');\n\n\t\t\tif(e.is('select')){\n\t\t\t\tconsole.log('** ERROR: deprecated use of <select> in the select type **');\n\t\t\t}\n\n\t\t\te.css('opacity', 0);\n\n\t\t\t/*\n\t\t\t * width(inputWidget.layers.items.width() - 26).\n\t\t\t */\n\t\t\tvar shim = self.shim = $('<div class=\"shim\" style=\"width:100%;height:100%;position:absolute;top:0;left:0;\"><div style=\"padding:0 25px 0 6px;overflow:hidden;\"><div style=\"overflow:hidden;\"></div></div></div>').insertAfter(e);\n\n\t\t\tinputWidget.field.addClass('select-box');\n\n\t\t\tself.iconClosed = $('<span class=\"tms-icon tms-icon-sort-down dropdown-closed-icon\"></span>').insertAfter(e);\n\t\t\tself.iconOpen = $('<span class=\"tms-icon tms-icon-sort-up dropdown-open-icon\"></span>').insertAfter(e).hide();\n\t\t\t/*\n\t\t\tself.iconClear = $('<span class=\"tms-icon tms-icon-erase clear-icon\"></span>').insertAfter(shim).on('click', function (ev) {\n\t\t\t\tev.stopPropagation();\n\t\t\t\tev.preventDefault();\n\t\t\t\tself.clear();\n\t\t\t\te.change();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t*/\n\t\t\tvar panel = self.panel = $('<div class=\"dropdown-panel\"><div class=\"tms-select-dropdown-content\"><div class=\"search\"/><div class=\"options\" style=\"position:relative;\"/></div></div>').hide();\n\t\t\tself.options = panel.find('.options');\n\n\t\t\tinputWidget.layers.items.append(panel).css('position', 'relative');\n\n\t\t\tvar selectionClass = self.sectionClass =  'selected';\n\n\t\t\tpanel.on('click', '.option', function () {\n\t\t\t\tself._setSelected();\n\t\t\t}).on('mouseenter', '.option', function () {\n\t\t\t\tpanel.find('.' + selectionClass).removeClass(selectionClass);\n\t\t\t\t$(this).addClass(selectionClass);\n\t\t\t}).on('mouseleave', '.option', function () {\n\t\t\t\t$(this).removeClass(selectionClass);\n\t\t\t});\n\n\t\t\tinputWidget.layers.items.on('click', function (ev) {\n\t\t\t\tif (inputWidget.states.disable) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar target = $(ev.target);\n\n\t\t\t\tif(target.childOf(panel, true)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.toggle();\n\t\t\t\t}, 0);\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * stop all enter and esc key events to leave the field\n\t\t\t */\n\t\t\t/*\n\t\t\tinputWidget.field.on('keydown', function (ev) {\n\n\t\t\t\tif(ev.which === 13){\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tself._setSelected();\n\t\t\t\t}\n\n\n\t\t\t\tif(ev.which === 27 || ev.which === 13){\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\tself.element.focus();\n\t\t\t\t}\n\n\t\t\t});\n\t\t\t*/\n\n\t\t\t/*\n\t\t\t * build filter input\n\t\t\t */\n\t\t\tvar filter = self.filter = $('<input type=\"text\" class=\"filter-box\" style=\"width:100%;position:relative;\" />').appendTo(panel.find('.search')).inputField();\n\t\t\tfilter.after('<span class=\"tms-icon tms-icon-search\" style=\"position:absolute;right: 7px;top: 1px; font-size: 15px; cursor: default;\"></span>');\n\t\t\tfilter.parents('.field-item').first().addClass('first');\n\n\t\t\tfilter.parent().css('display', 'block').parent().css('display', 'block').parent().css('display', 'block');\n\n\t\t\t/*\n\t\t\t * kill click event, to prevent the inputField from grabbing focus\n\t\t\t */\n\n\t\t\tfilter.on('click', function (ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * down 40\n\t\t\t * up 39\n\t\t\t * left 37\n\t\t\t * right 39\n\t\t\t */\n\n\n\t\t\te.on('keydown', $.proxy(self._keyDownNavigate, self));\n\t\t\tfilter.on('keydown', $.proxy(self._keyDownNavigate, self));\n\t\t\tfilter.on('keyup', $.proxy(self._onKeyup, self));\n\n\t\t\tfilter.on('dirty clean', function (ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t});\n\n\t\t\tself.closeListener = function (ev) {\n\t\t\t\tvar which = ev.which;\n\t\t\t\t/*\n\t\t\t\tif(ev.which === 9){\n\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\tif(which === 27 || which === 13){\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tev.stopPropagation();\n\n\t\t\t\t\tif(which === 13){\n\t\t\t\t\t\tself._setSelected();\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.element.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}, 0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar target = $(ev.target);\n\n\t\t\t\tif(!target.childOf(panel, true) && !target.childOf(fieldGroup, true)){\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tself.update();\n\t\t},\n\n\t\t_keyDownNavigate: function (ev) {\n\t\t\tvar self = this,\n\t\t\t\tpanel = self.panel,\n\t\t\t\tselectionClass = self.sectionClass,\n\t\t\t\twhich = ev.which;\n\n\t\t\t/*\n\t\t\t * special handling for tab\n\t\t\t */\n\t\t\tif(which === 9){\n\t\t\t\tself.element.next('input').focus();\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tif(which === 27 || which === 13){\n\t\t\t\tev.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar selected, next;\n\n\t\t\t/*\n\t\t\t * move down\n\t\t\t */\n\t\t\tif(which === 40){\n\n\t\t\t\tselected = panel.find('.' + selectionClass);\n\n\t\t\t\tif(!selected.length){\n\t\t\t\t\tpanel.find('.option:first').addClass(selectionClass);\n\t\t\t\t}else{\n\t\t\t\t\tnext = selected.next();\n\t\t\t\t\tif(next.length){\n\t\t\t\t\t\tnext.addClass(selectionClass);\n\t\t\t\t\t\tselected.removeClass(selectionClass);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself._scroll();\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * move down\n\t\t\t */\n\t\t\tif(which === 38){\n\n\t\t\t\tselected = panel.find('.' + selectionClass);\n\n\t\t\t\tif(!selected.length){\n\t\t\t\t\tpanel.find('.option:last').addClass(selectionClass);\n\t\t\t\t}else{\n\t\t\t\t\tnext = selected.prev();\n\t\t\t\t\tif(next.length){\n\t\t\t\t\t\tnext.addClass(selectionClass);\n\t\t\t\t\t\tselected.removeClass(selectionClass);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tself._scroll();\n\t\t\t}\n\n\t\t\tif(which < 32 || which > 126){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.open();\n\t\t},\n\n\t\t_onKeyup: function (ev) {\n\t\t\tvar self = this,\n\t\t\t\tfilter = self.filter,\n\t\t\t\twhich = ev.which,\n\t\t\t\tval = filter.val();\n\n\t\t\tif(self.filterValue === val){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.filterValue = val;\n\n\t\t\tself._filterOptions();\n\t\t},\n\n\t\t_setSelected: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tselected = self.panel.find('.selected:not(.filtered):visible');\n\n\t\t\t/*\n\t\t\t * use the first value if none of the options are selected\n\t\t\t */\n\t\t\tif(!selected.length){\n\t\t\t\tself._selectFirstNonEmptyOption();\n\t\t\t}\n\n\t\t\tselected = self.panel.find('.selected:not(.filtered):visible');\n\n\t\t\tvar item = self.item = selected.data('item');\n\n\t\t\t/*\n\t\t\t * TMS-1137\n\t\t\t * if nothing is selected, ignore this call\n\t\t\t */\n\t\t\tif(!item){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._setLabel(self.renderLabel(item));\n\n\t\t\tself.close();\n\t\t\te.val(self.item.value);\n\t\t\te.focus();\n\t\t\te.change();\n\t\t\tself.inputWidget.redraw();\n\t\t\tself.showHideCommand();\n\t\t},\n\n\t\t_selectFirstNonEmptyOption: function () {\n\t\t\tvar self = this;\n\t\t\tself._removeSelection();\n\t\t\tself.panel.find('.option:not(.filtered):visible').each(function () {\n\t\t\t\tvar option = $(this);\n\t\t\t\tif(option.html()){\n\t\t\t\t\toption.addClass('selected');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t_set: function (val) {\n\t\t\tvar self = this;\n\n\t\t\tself.filter.val('');\n\t\t\tself.filterValue = '';\n\n\t\t\tself.item = undefined;\n\n\t\t\tself.loaded.done(function () {\n\t\t\t\tself._removeSelection();\n\t\t\t\tvar options = self.panel.find('.option');\n\n\t\t\t\toptions.each(function () {\n\t\t\t\t\tvar item = $(this),\n\t\t\t\t\t\titemData = item.data('item');\n\n\t\t\t\t\tif(self._equal(itemData, val)){\n\t\t\t\t\t\titem.addClass('selected');\n\t\t\t\t\t\tself.item = itemData;\n\t\t\t\t\t\tself._setLabel(itemData.label);\n\t\t\t\t\t\tself.showHideCommand();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(!self.item || !self.item.value){\n\t\t\t\t\tif(self.inputWidget._trigger('itemnotfound', null, [val])){\n\t\t\t\t\t\tself._handleItemNotFound();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\t_removeSelection: function () {\n\t\t\tthis.panel.find('.option').removeClass('selected');\n\t\t},\n\n\t\t_handleItemNotFound: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\t\n\t\t\tself._setDefaultItem();\n\n\t\t\tif(!self.item || !self.item.value){\n\t\t\t\tself._selectFirstItem();\n\t\t\t}\n\t\t},\n\n\t\t_setDefaultItem: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\toptions = self.panel.find('.option'),\n\t\t\t\tdefaultValue =  { value: e.attr('data-default')};\n\n\t\t\toptions.each(function () {\n\t\t\t\tvar item = $(this),\n\t\t\t\t\titemData = item.data('item');\n\n\t\t\t\tif(self._equal(itemData, defaultValue)){\n\t\t\t\t\tif(e.attr('name') === 'params.category'){\n\t\t\t\t\t\tconsole.log('found defaultValue', defaultValue, itemData);\n\t\t\t\t\t}\n\t\t\t\t\titem.addClass('selected');\n\t\t\t\t\tself.item = itemData;\n\t\t\t\t\tself._setLabel(itemData.label);\n\t\t\t\t\tself.showHideCommand();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t_selectFirstItem: function() {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\toptions = self.panel.find('.option');\n\n\t\t\tself.item = options.first().addClass('selected').data('item');\n\t\n\t\t\tif(self.item && self.item.label) {\n\t\t\t\tself._setLabel(self.item.label);\n\t\t\t} else {\n\t\t\t\tself._setLabel('');\n\t\t\t}\n\n\t\t\tself.showHideCommand();\n\t\t},\n\n\t\tshowHideCommand: function () {\n\t\t\tvar self = this,\n\t\t\t\tshowClass = self.item && self.item.showClass,\n\t\t\t\tsections = self.showHideSections;\n\n\t\t\tif(!sections){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsections.hide();\n\n\t\t\tif(!showClass){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsections.filter('.' + showClass).show();\n\t\t},\n\n\t\tclear: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\t\t\tself.item = {};\n\t\t\tself.panel.find('.selected').removeClass('selected');\n\t\t\te.val('');\n\t\t\tself.filter.val('');\n\t\t\tself.filterValue = '';\n\t\t\tself._handleItemNotFound();\n\t\t\tself.inputWidget.redraw();\n\t\t},\n\n\t\t_equal: function (a, b) {\n\t\t\treturn a && b && a.value === b.value;\n\t\t},\n\n\t\t_setLabel: function (text) {\n\t\t\tthis.shim.children().children().text(text);\n\t\t},\n\n\t\t/*\n\t\t * used for testing\n\t\t */\n\t\t_getLabel: function () {\n\t\t\treturn this.shim.children().children().text();\n\t\t},\n\n\t\ttoggle: function () {\n\t\t\tvar self = this;\n\t\t\tif(self.panel.is(':visible')){\n\t\t\t\tself.close();\n\t\t\t}else{\n\t\t\t\tself.open();\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * this options was built for testing\n\t\t */\n\t\tgetOptions: function () {\n\t\t\tvar self = this,\n\t\t\t\toptionPanel = self.panel.find('.option'),\n\t\t\t\toptions = [];\n\n\t\t\toptionPanel.each(function () {\n\t\t\t\toptions.push($(this).data('item'));\n\t\t\t});\n\n\t\t\treturn options;\n\t\t},\n\n\t\t_filterOptions: function () {\n\t\t\tvar self = this;\n\t\t\tself._removeSelection();\n\t\t\tself.panel.addClass('filtering');\n\t\t\tif(self.filterTimer){\n\t\t\t\tclearTimeout(self.filterTimer);\n\t\t\t}\n\t\t\tself.filterTimer = setTimeout(function() {\n\t\t\t\tself.__filterOptionsWork();\n\t\t\t}, 200);\n\t\t},\n\n\t\t__filterOptionsWork: function (optionsElements) {\n\t\t\tvar self = this,\n\t\t\t\tval = self.filterValue;\n\n\t\t\t/*\n\t\t\tif(val && item.label && item.label.match(new RegExp($.ui.autocomplete.escapeRegex(val), 'i')) === null){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t*/\n\n\t\t\tself.panel.addClass('filtering');\n\n\t\t\tif(!optionsElements){\n\t\t\t\toptionsElements = self.panel.find('.option');\n\t\t\t}\n\t\t\t\n\t\t\tif(!optionsElements.length){\n\t\t\t\tself.panel.removeClass('filtering');\n\t\t\t\tself.inputWidget._trigger('filterdone');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar optionsToProcessNow = optionsElements.splice(0,1000);\n\n\t\t\t$.each(optionsToProcessNow, function (i, optionsEl) {\n\t\t\t\tself._filterItem($(optionsEl), val);\n\t\t\t});\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.__filterOptionsWork(optionsElements);\n\t\t\t}, 0);\n\t\t},\n\n\t\t_filterItem: function (optionEl, val) {\n\t\t\tvar self = this,\n\t\t\t\titem = optionEl.data('item');\n\n\t\t\tif(self._itemShoudBeFiltered(item, val)){\n\t\t\t\toptionEl.addClass('filtered');\n\t\t\t}else{\n\t\t\t\toptionEl.removeClass('filtered');\n\t\t\t}\n\t\t},\n\n\t\t_itemShoudBeFiltered: function (item, val) {\n\t\t\tif(!val){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(!item.label){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn item.label.match(new RegExp($.ui.autocomplete.escapeRegex(val), 'i')) === null;\n\t\t},\n\n\t\t_clearFilter: function () {\n\t\t\tvar self = this;\n\t\t\tself.filter.val('');\n\t\t\tself.panel.find('.option.filtered').removeClass('filtered');\n\t\t},\n\n\t\t_buildEmptyOption: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\temptyLabel = e.data('emptyLabel');\n\n\t\t\tif(emptyLabel !== '' && !emptyLabel){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.source.unshift({\n\t\t\t\tlabel: emptyLabel,\n\t\t\t\tvalue: ''\n\t\t\t});\n\t\t},\n\n\t\t_buildOptions: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tpanel = self.panel,\n\t\t\t\toptions = self.options;\n\n\t\t\t\n\t\t\tself.element.trigger('tmsselectbeforebuild');\n\n\t\t\toptions.empty();\n\n\t\t\tvar optionsbuffer = $('<div/>');\n\n\t\t\tif (!e.data('noSort')) {\n\t\t\t\tself._sort(self.source);\n\t\t\t}\n\n\t\t\tself._buildEmptyOption();\n\n\t\t\t$.each(self.source, function (i, item) {\n\t\t\t\t\n\t\t\t\tvar option = $('<div class=\"option\"/>'),\n\t\t\t\t\trenderedItem = self.renderItem(item);\n\n\t\t\t\tif(renderedItem !== null){\n\t\t\t\t\toption.append(renderedItem).data('item', item);\n\t\t\t\t\toptionsbuffer.append(option);\n\t\t\t\t}\n\n\t\t\t\tif(renderedItem === ''){\n\t\t\t\t\toption.height(20);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\toptions.append(optionsbuffer);\n\t\t\tself.element.trigger('tmsselectafterbuild', [options]);\n\t\t},\n\n\t\t_sort: function (items) {\n\t\t\titems.sort(function (a, b) {\n\t\t\t\tif (!a || !b) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar al = a.label.toLowerCase(), bl = b.label.toLowerCase();\n\t\t\t\treturn al > bl ? 1 : al < bl ? -1 : a.label > b.label ? 1 : a.label < b.label ? -1 : 0;\n\t\t\t});\n\t\t},\n\n\t\t_scroll: function () {\n\t\t\tvar self = this,\n\t\t\t\toptions = self.options;\n\n\t\t\tif(!self.panel.is(':visible')){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout(function() {\n\n\t\t\t\tvar selected = self.panel.find('.selected'),\n\t\t\t\t\ttop;\n\n\t\t\t\tif(selected.length === 0){\n\t\t\t\t\ttop = 0;\n\t\t\t\t}else{\n\t\t\t\t\ttop = selected.position().top;\n\t\t\t\t}\n\n\t\t\t\toptions.scrollTop(top + selected.height());\n\t\t\t}, 0);\n\n\n\t\t\t/*\n\t\t\tsetTimeout(function() {\n\t\t\t\tpanel.find('.options').scrollTop(0);\n\t\t\t}, 0);\n\t\t\t*/\n\t\t},\n\n\t\topen: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tpanel = self.panel,\n\t\t\t\tinputLayer = self.inputWidget.layers.input,\n\t\t\t\titemsLayer = self.inputWidget.layers.items;\n\n\n\t\t\tif(panel.is(':visible')){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.filterValue = '';\n\n\t\t\tdoc.on('click keyup', self.closeListener);\n\n\t\t\tvar leftOffset = 0;\n\t\t\tif(inputLayer.index()){\n\t\t\t\tleftOffset = inputLayer.position().left - 1;\n\t\t\t}\n\n\t\t\tpanel.width(e.width()).css({\n\t\t\t\tleft: leftOffset,\n\t\t\t\ttop: (itemsLayer.height() - 1) + 'px',\n\t\t\t\twidth: (e.outerWidth() ) + 'px'\n\t\t\t}).hide();\n\n\t\t\tself.iconClosed.hide();\n\t\t\tself.iconOpen.show();\n\t\t\tpanel.show();\n\t\t\tself.filter.focus();\n\t\t\t//self.filter.hide();\n\n\t\t\tself._scroll();\n\t\t},\n\n\t\trenderLabel: function (item) {\n\t\t\treturn (item && item.label) || '';\n\t\t},\n\n\t\trenderItem: function (item) {\n\t\t\treturn item.label;\n\t\t},\n\n\t\tclose: function () {\n\t\t\tvar self = this,\n\t\t\t\tpanel = self.panel,\n\t\t\t\tfilter = self.filter;\n\n\t\t\tdoc.off('click keyup', self.closeListener);\n\t\t\tpanel.hide();\n\n\t\t\tself._clearFilter();\n\n\t\t\tself.iconClosed.show();\n\t\t\tself.iconOpen.hide();\n\t\t},\n\n\t\tupdate: function () {\n\t\t\tvar self = this,\n\t\t\t\te =self.element;\n\n\t\t\tself.loaded = $.Deferred();\n\t\t\tself.load().done(function (source) {\n\t\t\t\tif (!source) {\n\t\t\t\t\tsource = [];\n\t\t\t\t}\n\t\t\t\tself.source = source;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.removeInvalid();\n\t\t\t\t}, 0);\n\n\t\t\t\tself._buildOptions();\n\n\t\t\t\t/*\n\t\t\t\t * hide the filter if less then five items are returned\n\t\t\t\t */\n\t\t\t\tif (self.filter && self.filter.data('inputField')) {\n\t\t\t\t\tif(source.length < 5){\n\t\t\t\t\t\tself.filter.inputField('hide');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.filter.inputField('show');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * scan for showClass commands\n\t\t\t\t */\n\t\t\t\tvar form, sections = $([]);\n\t\t\t\t$.each(source, function (i, item) {\n\t\t\t\t\tif(item.showClass){\n\t\t\t\t\t\tif(!form){\n\t\t\t\t\t\t\tform = e.parents(':add123-formBuilder').first();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsections = sections.add(form.find('.' + item.showClass));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tself.showHideSections = sections;\n\t\t\t\tself.loaded.resolve();\n\t\t\t\tself.showHideCommand();\n\t\t\t});\n\t\t\treturn self.loaded;\n\t\t},\n\n\t\tremoveInvalid: function (ev, ui) {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tval = e.val(),\n\t\t\t\tsource = self.source,\n\t\t\t\tl = source.length,\n\t\t\t\ti;\n\n\t\t\t/*\n\t\t\t * if ui.item is set, the autocomplete just set this\n\t\t\t * and it does not need to be checked\n\t\t\t */\n\t\t\tif(ui && ui.item){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * verify that the current self.item matches an id in the source and that the label matches\n\t\t\t */\n\t\t\tfor(i = 0; i < l; i++){\n\t\t\t\tif(source[i].label === val && self.item && self.item.id === source[i].id){\n\t\t\t\t\tself.item = source[i];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\te.val('');\n\t\t},\n\n\t\t/*\n\t\t * returns a sorted array of objects that have value and label properties\n\t\t */\n\t\tload: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tsource = [],\n\t\t\t\tdataOptions = e.attr('data-options');\n\n\t\t\tif(dataOptions) {\n\t\t\t\tsource = $.parseJSON(dataOptions);\n\t\t\t} else {\n\t\t\t\te.find('option').each(function () {\n\t\t\t\t\tvar option = $(this);\n\t\t\t\t\tsource.push({\n\t\t\t\t\t\tlabel: option.text(),\n\t\t\t\t\t\tvalue: option.val()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn $.when(source);\n\t\t},\n\n\t\tmap: function (raw) {\n\t\t\treturn {\n\t\t\t\tlabel: raw,\n\t\t\t\tvalue: raw\n\t\t\t};\n\t\t},\n\n\t\tdeMap: function (obj) {\n\t\t\tif(!obj){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn obj.value || null;\n\t\t},\n\n\t\tisEmpty: function () {\n\t\t\tvar self = this,\n\t\t\t\tdata = self.deMap(self.item);\n\n\t\t\treturn data !== 0 && !data;\n\t\t},\n\n\t\tconverter: {\n\n\t\t\tfromField: function () {\n\t\t\t\tvar self = this,\n\t\t\t\t\tdata = self.item;\n\t\t\t\tif(data === undefined){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar val = self.deMap(data);\n\n\t\t\t\tif(val === undefined){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn val;\n\t\t\t},\n\n\t\t\ttoField: function (rawdata) {\n\t\t\t\tvar self = this,\n\t\t\t\t\te = self.element,\n\t\t\t\t\tdata = self.map(rawdata);\n\n\t\t\t\tif(!rawdata && typeof e.data('default') !== 'undefined') {\n\t\t\t\t\tdata = self.map(e.data('default'));\n\t\t\t\t}\n\n\t\t\t\tif (!data) {\n\t\t\t\t\tself.clear();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself._set(data);\n\n\t\t\t\treturn data.label;\n\t\t\t}\n\t\t}\n\t};\n\n})(jQuery);","/*\n * Define general types\n */\n(function($) {\n\t\"use strict\";\n\n\tvar doc = $(document);\n\n\t/*\n\t * InputField Types\n\t *\n\t * Type objects are of the form:\n\t * {\n\t *   setUp : function (ui) {},\n\t *   tearDown : function (ui) {},\n\t *   converter : {\n\t *     toField : function (value, ui) {},\n\t *     fromField : function (value, ui) {}\n\t *   },\n\t *   format : function (ui) {}\n\t *   validate : function (ui) {}\n\t * }\n\t * and stored in $.add123.inputField.types\n\t *\n\t * The context (this) will get set to the context of the type object, use the ui parameter to obtain access to the inputField widget\n\t *\n\t * setUp: add any events, elements, etc.\n\t *\n\t * tearDown: reverse whatever setUp did\n\t *\n\t * converter: used to convert data between \"human\" and transport formats (e.g. mm/dd/yyyy <-> yyyymmdd)\n\t *\n\t * format: attempt to format the human readable value (e.g. mm/ dd/yyyy -> mm/dd/yyyy, '  foo ' -> 'foo')\n\t *    format is called on before validate\n\t *\n\t * validate: returns an error object on error or undefined on success\n\t * err: {\n\t *   message: '',\n\t *   code: '',\n\t *   description: ''\n\t * }\n\t *\n\t */\n\t\n\t var types = $.add123.inputField.types;\n\n\t/*\n\t * the default type\n\t */\n\ttypes.text = {};\n\n\tvar cannedFormatters = {\n\t\ttrim: function(ui) {\n\t\t\tvar e = ui.element;\n\t\t\te.val($.trim(e.val()));\n\t\t}\n\t};\n\n\t/*\n\t * helper function to build basic types\n\t */\n\tvar createRegexType = function(pattern, filter, flags, max) {\n\t\tif(flags === undefined) {\n\t\t\tflags = {};\n\t\t}\n\t\tif(flags.toUpper !== false) {\n\t\t\tflags.toUpper = true;\n\t\t}\n\n\t\tvar type = {\n\t\t\tvalidate: function(ui) {\n\t\t\t\tif(!ui.element.val().match(pattern)) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmessage: 'invalid'\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif(filter || max) {\n\t\t\ttype.setUp = function(ui) {\n\n\t\t\t\tvar filterData = {\n\t\t\t\t\tpattern: filter || /./,\n\t\t\t\t\ttoUpper: flags.toUpper,\n\t\t\t\t\tmax: max || 0\n\t\t\t\t};\n\n\t\t\t\tif(ui.element.attr('data-max')){\n\t\t\t\t\tfilterData.max = ui.element.attr('data-max');\n\t\t\t\t}\n\n\t\t\t\t//console.log('setup ', ui.element.attr('name'), filterData, max);\n\t\t\t\tui.element.inputFilter(filterData);\n\t\t\t};\n\t\t}\n\n\t\tif(flags.cannedFormatter !== undefined) {\n\t\t\tif($.isFunction(cannedFormatters[flags.cannedFormatter])) {\n\t\t\t\ttype.format = cannedFormatters[flags.cannedFormatter];\n\n\t\t\t\t// add converters\n\t\t\t\ttype.converter = {\n\t\t\t\t\ttoField: function (val, ui) { return type.format(ui); },\n\t\t\t\t\tfromField: function (val, ui) { return type.format(ui); }\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn type;\n\t};\n\t$.add123.inputField.createRegexType = createRegexType;\n\n\n\t/*\n\t * basic types\n\t */\n\t$.extend(types, {\n\t\t'utext': createRegexType(/.*/, /.*/, {\n\t\t\ttoUpper: true\n\t\t}),\n\t\t'integer': createRegexType(/^[0-9]*$/, /[0-9]/),\n\t\t'number': createRegexType(/^-?[0-9]+\\.?[0-9]*$/, /[-0-9.]/),\n\t\t'state': createRegexType(/^[A-Z]{2}$/, /[A-Z]/, {}, 2),\n\t\t'feid': createRegexType(/^[0-9]{2}\\-?[0-9]{7}$/, /[0-9\\-]/, {}, 10),\n\t\t'zip': createRegexType(/(^\\d{5}(\\-?\\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\\d{1}[A-Z]{1} ?\\d{1}[A-Za]{1}\\d{1})$/, /[0-9A-Z\\s\\-]/, {}, 10),\n\t\t'email': createRegexType(/^(?!.*\\.{2})[A-Za-z0-9._%+\\-]+@[A-Za-z0-9.\\-]+\\.[A-Za-z]{2,4}$/, /[A-Za-z0-9._%+\\-@]/, {\n\t\t\ttoUpper: false,\n\t\t\tcannedFormatter: 'trim'\n\t\t})\n\t});\n\n\n\ttypes.display = {\n\t\tsetUp: function (ui) {\n\t\t\tvar e = ui.element;\n\n\t\t\te.parents('.field-item').hide();\n\t\t\te.parents('.field-items').append('<div class=\"input-display\"></div>');\n\t\t},\n\n\t\tconverter: {\n\t\t\ttoField: function (val, ui) {\n\t\t\t\tvar e = ui.element;\n\n\t\t\t\te.parents('.field-items').find('.input-display').html(val);\n\t\t\t},\n\t\t\tfromField: function(value, ui) {\n\t\t\t\treturn e.parents('.field-items').find('.input-display').html().trim();\n\t\t\t}\n\t\t}\n\t};\n\n\n\ttypes.phone = {\n\t\tsetUp: function (ui) {\n\t\t\tvar self = this,\n\t\t\t\te = ui.element;\n\n\t\t\te.inputFilter({\n\t\t\t\tpattern: /[0-9()\\s\\-x]/\n\t\t\t});\n\n\t\t\te.on('blur', function() {\n\t\t\t\te.val(self.format(e.val()));\n\t\t\t});\n\n\t\t},\n\n\t\tconverter: {\n\t\t\ttoField: function(val, ui) {\n\t\t\t\treturn this.format(val);\n\t\t\t},\n\t\t\tfromField: function(val, ui) {\n\t\t\t\treturn this.format(val);\n\t\t\t}\n\t\t},\n\n\t\tformat: function (text) {\n\n\t\t\tif(!text){\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * find extension delimeter\n\t\t\t */\n\t\t\tvar extensionStart = 0,\n\t\t\t\txlocation = text.indexOf('x'),\n\t\t\t\tlastSpace = text.lastIndexOf(' '),\n\t\t\t\text = '',\n\t\t\t\textraExt = '';\n\n\t\t\tif(xlocation > 0){\n\t\t\t\textensionStart = xlocation;\n\t\t\t}else if(lastSpace > 7){\n\t\t\t\textensionStart = lastSpace;\n\t\t\t}\n\n\t\t\tif(extensionStart > 0){\n\t\t\t\text = text.substring(extensionStart + 1);\n\t\t\t\ttext = text.substring(0, extensionStart);\n\t\t\t}\n\n\t\t\tvar num = $.trim(text.replace(/[()\\s\\-]/g, '')),\n\t\t\t\tnumberLength = num.length;\n\n\n\t\t\tif(num[0] === '1'){\n\t\t\t\tnum = num.substring(1);\n\t\t\t\tnumberLength--;\n\t\t\t}\n\n\t\t\tif(numberLength > 10){\n\t\t\t\textraExt = num.substring(10);\n\t\t\t\tnum = num.substring(0, 10);\n\t\t\t\tnumberLength = 10;\n\t\t\t}\n\n\t\t\tif (numberLength === 7) {\n\t\t\t\tnum = num.substring(0,3) + '-' + num.substring(3);\n\t\t\t} else if (numberLength === 10) {\n\t\t\t\tnum = num.substring(0,3) + '-' + num.substring(3,6) + '-' + num.substring(6);\n\t\t\t}\n\n\t\t\text = extraExt + ext;\n\n\t\t\tnum = num.replace(/[^0-9^x^-]/g, '');\n\t\t\text = ext.replace(/[^0-9^x^-]/g, '');\n\n\t\t\tif(ext){\n\t\t\t\tnum += 'x' + ext;\n\t\t\t}\n\n\t\t\treturn num;\n\t\t},\n\t\tvalidate: function(ui) {\n\t\t\t///^([0-9]{3}-)?[0-9]{3}-[0-9]{4}(x[0-9]+)?$/ simple regex\n\t\t\tif(!ui.element.val().match(/^(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?$/)) {\n\t\t\t\treturn {\n\t\t\t\t\tmessage: 'invalid'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t};\n\n\ttypes.money = {\n\t\tsetUp: function (ui) {\n\t\t\tvar self = this,\n\t\t\t\te = ui.element;\n\n\t\t\tself.element = e;\n\n\t\t\te.inputFilter({\n\t\t\t\tpattern: /[0-9\\.]/\n\t\t\t}).change(function () {\n\t\t\t\tself._onChange();\n\t\t\t}).blur(function() {\n\t\t\t\te.val(self.format(e.val()));\n\t\t\t});\n\n\t\t\tif(!(e.data('currency-symbol'))) {\n\t\t\t\tui.addOn(-100, '$');\n\t\t\t} else {\n\t\t\t\tui.addOn(-100, e.data('currency-symbol'));\n\t\t\t}\n\t\t\t\n\t\t},\n\t\t_onChange: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element,\n\t\t\t\tcaret = e.caret();\n\n\t\t\te.val(self.format(e.val())).caret(caret.begin, caret.end);\n\t\t},\n\n\t\tformat: function (money) {\n\t\t\tif($.trim(money) === ''){\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\ttry {\n\t\t\t\t// MISC-916 removed extra decimals that cause NaN\n\t\t\t\tif(isNaN(money)) {\n\t\t\t\t\tmoney = money.toString();\n\t\t\t\t\tvar count = 0; \n\t\t\t\t\tfor(var i = 0; i < money.length; i++){\n\n\t\t\t\t\t\tif((money[i]) === '.'){\n\t\t\t\t\t\tcount++;}\n\t\t\t\t\t}\n\t\t\t\t\tvar dec = money.indexOf('.');\n\t\t\t\t\tif(dec != -1) {\n\t\t\t\t\t\tmoney = money.replace(/\\./g,'');\n\t\t\t\t\t\tmoney = money.substring(0,dec) + '.' + money.substring(dec);\n\t\t\t\t\t}\t\t\t\n\t\t\t\t\tmoney = parseFloat(money);\n\t\t\t\t}\n\t\t\t\treturn (+money).toFixed(2);\n\t\t\t} catch(err) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t\tconverter: {\n\t\t\ttoField: function(val, ui) {\n\t\t\t\treturn this.format(val);\n\t\t\t},\n\t\t\tfromField: function(val, ui) {\n\t\t\t\tif($.trim(val) === ''){\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\treturn +this.format(val);\n\t\t\t}\n\t\t}\n\t};\n\n\t/*\n\t * Date Type Support (date)\n\t *\n\t * calendar pop-up\n\t * TODO: clean up year range support, add range setters in the type\n\t */\n\ttypes.date = {\n\t\tsetUp: function(ui) {\n\t\t\tvar self = this,\n\t\t\t\te = ui.element;\n\n\t\t\tvar minYear = new Date().getFullYear() - 15,\n\t\t\t\tmaxYear = new Date().getFullYear() + 2;\n\n\t\t\tvar layers = ui.layers;\n\n\t\t\t//o._field.addClass('pad1');\n\t\t\tif(e.data('minyear') !== undefined) {\n\t\t\t\tminYear = e.data('minyear');\n\t\t\t}\n\t\t\tif(e.data('maxyear') !== undefined) {\n\t\t\t\tif(e.data('maxyear') === 'CURRENT') {\n\t\t\t\t\tmaxYear = new Date().getFullYear();\n\t\t\t\t} else {\n\t\t\t\t\tmaxYear = e.data('maxyear');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//layers.placeholder.html('MM/DD/YYYY');\n\t\t\tui.placeholder('MM/DD/YYYY');\n\n\t\t\tvar datePickerOptions = {\n\t\t\t\tonSelect: function(dateText, inst) {\n\t\t\t\t\tui.redraw();\n\t\t\t\t\tself.format();\n\t\t\t\t\tui.validate();\n\t\t\t\t\tui.checkDirty();\n\t\t\t\t\te.trigger('ondateselect');\n\t\t\t\t},\n\t\t\t\tshowOn: 'none',\n\t\t\t\tchangeMonth: true,\n\t\t\t\tchangeYear: true,\n\t\t\t\tyearRange: minYear + ':' + maxYear\n\t\t\t};\n\n\t\t\tif(util.lang.code !== 'en') {\n\t\t\t\t$.extend(datePickerOptions, $.datepicker.regional[util.lang.code]);\n\t\t\t}\n\n\t\t\te.datepicker(datePickerOptions).inputFilter({\n\t\t\t\tpattern: /[0-9\\/]/,\n\t\t\t\tmax : 10,\n\t\t\t\ttoUpper: true\n\t\t\t});\n\n\t\t\tvar datePickerDiv = $('#ui-datepicker-div');\n\t\t\t//img/calendar.gif\n\t\t\t//\n\n\n\n\t\t\tvar addon = ui.addOn(0, '<span class=\"calendar-icon\"></span>', 'clickable');\n\t\t\taddon.click(function(ev) {\n\n\t\t\t\tif(datePickerDiv.is(':visible')) {\n\t\t\t\t\te.datepicker('hide');\n\t\t\t\t} else {\n\t\t\t\t\t/*\n\t\t\t\t\t * align to the right of the field, TODO: this could use more work and testing\n\t\t\t\t\t *\n\t\t\t\t\tdatePickerDiv.css({\n\t\t\t\t\t\tmarginLeft: o._layers.wrapper.outerWidth() + 'px'\n\t\t\t\t\t});\n\t\t\t\t\t*/\n\t\t\t\t\te.datepicker('show');\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\tconverter: {\n\t\t\t/*\n\t\t\t * Store date in XSD standard: yyyy-mm-dd <=> mm/dd/yyyy\n\t\t\t */\n\t\t\ttoField: function(val, ui) {\n\t\t\t\tif(!val || !val.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\treturn val.substring(5, 7) + '/' + val.substring(8, 10) + '/' + val.substring(0, 4);\n\t\t\t},\n\t\t\tfromField: function(val, ui) {\n\t\t\t\tif(!val || !val.match(/^[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}$/)) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\treturn val.substring(6, 10) + '-' + val.substring(0, 2) + '-' + val.substring(3, 5);\n\t\t\t}\n\t\t},\n\t\tformat: function () {\n\n\t\t},\n\t\ttearDown: function() {\n\t\t\t//TODO:\n\t\t},\n\n\t\tvalidate: function(ui) {\n\t\t\tvar self = this,\n\t\t\t\tdate = ui.element.val();\n\t\t\tif(!moment(date, [\"MM/DD/YYYY\"], true).isValid()) {\n\t\t\t\treturn {\n\t\t\t\t\tmessage: 'invalid'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t};\n\n\ttypes.dateTime = $.extend({}, types.date, {\n\t\tsetUp: function(fieldWidget) {\n\t\t\tvar self = this,\n\t\t\t\te = fieldWidget.element;\n\n\t\t\tself.element = e;\n\n\t\t\ttypes.date.setUp.call(self, fieldWidget);\n\n\t\t\te.inputFilter('setPattern', /[0-9\\/: PAM]/).inputFilter('setMax', 19);\n\n\t\t\tif(!e.data('hours')) {\n\t\t\tfieldWidget.placeholder('MM/DD/YYYY HH:MM AM/PM');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfieldWidget.placeholder('MM/DD/YYYY HH:MM');\n\t\t\t}\n\t\t},\n\n\t\tconverter: {\n\t\t\t/*\n\t\t\t * Store date in XSD standard: yyyy-mm-dd <=> mm/dd/yyyy\n\t\t\t */\n\t\t\ttoField: function(val, ui) {\n\t\t\t\tif(!val || !val.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$/)) { // Take the same but return different \n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tif(!ui.element.data('hours')) {\n\t\t\t\t\t\n\t\t\t\t\treturn moment(val).utc().local().format('MM/DD/YYYY h:mm A');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn moment(val).utc().local().format('MM/DD/YYYY H:mm');\n\t\t\t\t}\n\t\t\t},\n\t\t\tfromField: function(val, ui) {\n\n\t\t\t\t\tif(!ui.element.data('hours')) {\n\n\t\t\t\t\t\tif(!val || !val.match(/^[0-9]{2}\\/[0-9]{2}\\/[0-9]{4} [0-9]{1,2}:[0-9]{2} (AM)|(PM)$/)) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\treturn moment(val, 'MM/DD/YYYY h:mm a').utc().format('YYYY-MM-DDTHH:mm:ss') + 'Z';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(!val || !val.match(/^[0-9]{2}\\/[0-9]{2}\\/[0-9]{4} [0-9]{1,2}:[0-9]{2}$/))  {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\treturn moment(val, 'MM/DD/YYYY H:mm').utc().format('YYYY-MM-DDTHH:mm:ss') + 'Z';\n\t\t\t\t}\n\t\t\t\t\n\n\t\t\t\t\n\t\t\t}\n\t\t},\n\n\t\tformat: function () {\n\t\t\tvar self = this,\n\t\t\t\te = self.element;\n\n\t\t\tvar s = e.val();\n\n\t\t\tif(s.match(/^[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}$/)){\n\t\t\t\t/*\n\t\t\t\t * append default time\n\t\t\t\t */\n\n\t\t\t\tif(!e.data('hours'))\n\t\t\t\t{\n\t\t\t\t\ts += ' 12:00 PM';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ts += ' 12:00';\n\t\t\t\t}\n\t\t\t\te.val(s);\n\n\t\t\t}\n\n\t\t},\n\n\t\tvalidate: function(ui) {\n\t\t\tvar value = ui.element.val().trim(),\n\t\t\t\tinvalidMessage = {message: 'invalid'},\n\t\t\t\tself = this,\n\t\t\t\te = self.element,\n\t\t\t\tformat;\n\n\t\t\tif(!e.data('hours')) {\n\t\t\t\tformat = 'MM/DD/YYYY h:mm A';\n\t\t\t\n\t\t\t\tif(!value.match(/^[0-9]{1,2}\\/[0-9]{1,2}\\/[0-9]{4}\\s([0-9]{1,2}|(1[0-2])):([0-5][0-9])\\s(?:(AM)|(PM))$/)) {\n\t\t\t\t\treturn invalidMessage;\n\t\t\t\t}\n\n\t\t\t} \n\t\t\telse {\n\t\t\t\tformat = 'MM/DD/YYYY H:mm';\n\n\t\t\t\tif((!value.match(/^[0-9]{1,2}\\/[0-9]{1,2}\\/[0-9]{4}\\s([01]?[[0-9]|(2[0-3])):([0-5][0-9])$/))) {\n\t\t\t\t\treturn invalidMessage;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// console.log(moment(value, format).format('MM/DD/YYYY, h:mm:ss a'));\n\t\t\tif(!moment(value, format, true).isValid()) {\n\t\t\t\treturn invalidMessage;\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t});\n\n\t/*\n\t * setup Spanish support in the date picker UI\n\t */\n\t$.datepicker.regional.es = {\n\t\tcloseText: 'Cerrar',\n\t\tprevText: '&#x3c;Ant',\n\t\tnextText: 'Sig&#x3e;',\n\t\tcurrentText: 'Hoy',\n\t\tmonthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],\n\t\tmonthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],\n\t\tdayNames: ['Domingo', 'Lunes', 'Martes', 'Mi&eacute;rcoles', 'Jueves', 'Viernes', 'S&aacute;bado'],\n\t\tdayNamesShort: ['Dom', 'Lun', 'Mar', 'Mi&eacute;', 'Juv', 'Vie', 'S&aacute;b'],\n\t\tdayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'S&aacute;'],\n\t\tweekHeader: 'Sm',\n\t\tdateFormat: 'dd/mm/yy',\n\t\tfirstDay: 1,\n\t\tisRTL: false,\n\t\tshowMonthAfterYear: false,\n\t\tyearSuffix: ''\n\t};\n\n\n})(jQuery);"]}