(function($){$.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],daysShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","S&aacute;"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Borre",rtl:false}})(jQuery);if(typeof window.util==="undefined")window.util={};(function($){"use strict";if(typeof window.console==="undefined"){window.console={log:function(){},dir:function(){},timeStamp:function(){},time:function(){},timeEnd:function(){}}}if(typeof console.timeStamp==="undefined"){console.timeStamp=function(){}}if(typeof console.time==="undefined"){console.time=function(){}}if(typeof console.timeEnd==="undefined"){console.timeEnd=function(){}}if(typeof Object.create==="undefined"){Object.create=function(o){function F(){}F.prototype=o;return new F}}var langCodes={en:"English",es:"Español",fr:"Français"};if(typeof util.lang==="undefined")util.lang={};if(typeof util.lang.code==="undefined")util.lang.code="en";if(typeof util.selectPath==="undefined"){util.selectPath=function(namespace,domKey){if(namespace===undefined){return}if(domKey===undefined||domKey===""){return namespace}var i,a=domKey.toString().split(".");for(i=0;i<a.length;i+=1){var key=a[i];if(key.match(/^[0-9]{1,3}$/)){key=parseInt(key,10)}if(key===0&&!$.isArray(namespace)){continue}if(namespace===undefined||namespace===null){return undefined}namespace=namespace[key];if(i===a.length-1||namespace===undefined){return namespace}}}}if(typeof util.insertPath==="undefined"){util.insertPath=function(namespace,domKey,obj){var i,a=domKey.split("."),origRef=namespace;var types=[],key,type;for(i=0;i<a.length;i+=1){key=a[i];if(i===a.length-1){if(key.match(/^[0-9]{1,3}$/)){types[types.length-1]={k:types[types.length-1].k,v:[]};types.push({k:parseInt(key,10),v:obj})}else{types.push({k:key,v:obj})}}else if(key.match(/^[0-9]{1,3}$/)){types[types.length-1]={k:types[types.length-1].k,v:[]};types.push({k:parseInt(key,10),v:{}})}else{types.push({k:key,v:{}})}}for(i=0;i<types.length;i+=1){type=types[i];key=type.k;if(i===a.length-1){namespace[key]=type.v}else{if(typeof namespace[key]==="undefined"){namespace[key]=type.v}namespace=namespace[key]}}return origRef}}if(typeof util.deletePath==="undefined"){util.deletePath=function(namespace,domKey){var a=domKey.split("."),i;for(i=0;i<a.length;i+=1){if(i===a.length-1){delete namespace[a[i]]}else{if(typeof namespace[a[i]]==="undefined"){return}namespace=namespace[a[i]]}}}}if(typeof $.fn.childOf==="undefined"){$.fn.childOf=function(b,includeSelf){var i;if(b instanceof jQuery){b=b[0]}if(includeSelf&&b===this[0]){return true}var p=this.parents();for(i=0;i<p.length;i++){if(b===p[i]){return true}}return false}}if(typeof window.isEmpty==="undefined"){window.isEmpty=function isEmpty(a){if(a===0){return false}return!a}}if(typeof util.equals==="undefined"){util.equals=function(a,b){var p;if(a===b){return true}if(isEmpty(a)&&isEmpty(b)){return true}if(isEmpty(a)||isEmpty(b)){return false}switch(typeof a){case"object":for(p in a){if(a.hasOwnProperty(p)){if(!util.equals(a[p],b[p])){return false}}}for(p in b){if(b.hasOwnProperty(p)){if(!util.equals(a[p],b[p])){return false}}}break;case"function":if(typeof b==="undefined"||a.toString()!==b.toString()){return false}break;default:if(a.toString()!==b.toString()){return false}}return true}}if(typeof util.removeEqual==="undefined"){util.removeEqual=function(a,b,ignoreDiffKeys){var p,remove,removeTmp;if(!ignoreDiffKeys){ignoreDiffKeys=[]}if(a===undefined||b===undefined){return}switch(typeof a){case"object":remove=true;for(p in a){if(a.hasOwnProperty(p)){if($.inArray(p,ignoreDiffKeys)>-1){removeTmp=true}else{removeTmp=util.removeEqual(a[p],b[p])}if(removeTmp){delete a[p];delete b[p]}remove=remove&&removeTmp}}return remove;default:return a.toString()===b.toString()}}}$.widget("add123.spin",{options:{lines:10,length:4,width:2,radius:3,rotate:0,color:"#000",speed:1.5,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:0,top:"0",left:"0"},_spinner:undefined,_create:function(){var self=this;self._spinner=new Spinner(self.options)},_init:function(){this.start()},start:function(){this._spinner.spin(this.element[0])},stop:function(){this._spinner.stop()},_destroy:function(){var self=this;self.stop();delete self._spinner}})})(jQuery);(function($){$.fn.caret=function(begin,end){if(this.length===0){return this}var input=this[0],range;if(typeof begin==="number"){if(!$(input).is(":visible")){return input}end=typeof end==="number"?end:begin;if(input.setSelectionRange){input.focus();input.setSelectionRange(begin,end);try{if(end===input.value.length){input.scrollLeft=9999999999}}catch(err){}}else if(input.createTextRange){range=input.createTextRange();range.collapse(true);range.moveEnd("character",end);range.moveStart("character",begin);range.select()}}else{if(!$(input).is(":visible")){var l=$(input).val().length;return{begin:l,end:l}}if(input.setSelectionRange){begin=input.selectionStart;end=input.selectionEnd}else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=-range.duplicate().moveStart("character",-1e5);end=begin+range.text.length}return{begin:begin,end:end}}return input}})(jQuery);(function($){"use strict";$.widget("add123.formBuilder",{options:{converter:{fromForm:function(data){return data},toForm:function(data){return data}},ignoreHidden:false},_create:function(){var self=this,o=self.options,e=self.element;self.baseData={};o.defaultRequired=e.data("default-required");self.fieldsWidgets=$([]);self.fields=$([]);self.scanForNewFields();self.dirty=false;e.on("dirty",function(ev){if(self.dirty){ev.stopPropagation();return}self.dirty=true}).on("clean",function(ev){if(!self.dirty){ev.stopPropagation();return}self.dirty=self.isDirty();if(self.dirty){ev.stopPropagation()}});e.show()},scanForNewFields:function(){var self=this,o=self.options,e=self.element;e.find("[data-load-widget-as-field]").each(function(){var el=$(this);if(!el.attr("name")){throw new Error("data-load-widget-as-field must have name attribute")}if(self.fieldsWidgets.has(el[0]).length){return}el[el.attr("data-load-widget-as-field")]();self.fieldsWidgets=self.fieldsWidgets.add(el);var label=el.attr("data-label");if(!label){return}el.addClass("field-items").wrap('<div class="input-field-group"><div class="input-field"></div></div>').before("<label>"+label+"</label>")});e.find("input[type!=submit], select, textarea").not(":add123-inputField").not(".form-builder-ignore *").each(function(){var newInput=$(this);if(newInput.is("[data-load-widget-as-field]")||newInput.parents("[data-load-widget-as-field]").length){return}newInput.inputField({require:!!o.defaultRequired});self.fields=self.fields.add(newInput)});e.find(".input-field-group").each(function(){$(this).find(".field-item:first").addClass("first")})},_proxyCommandToWidget:function(widgetElement){var self=this,widgetName=widgetElement.data("load-widget-as-field")||"inputField",instance=widgetElement.data(widgetName),method=Array.prototype.splice.call(arguments,1,1),args=Array.prototype.slice.call(arguments,1);try{return instance[method].apply(instance,args)}catch(err){throw new Error("ERROR: widget field error NAME["+widgetName+"] METHOD["+method+"]")}},isDirty:function(){var self=this,dirty=false;self.fields.each(function(){dirty=!!$(this).inputField("isDirty");return!dirty});if(dirty){return dirty}self.fieldsWidgets.each(function(){dirty=!!self._proxyCommandToWidget($(this),"isDirty");return!dirty});return dirty},clearDirty:function(){var self=this;self.dirty=false;self.fields.each(function(){$(this).inputField("clearDirty")});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),"clearDirty")})},flashDirty:function(numberOfTimes){},flashError:function(numberOfTimes){this.fields.filter(function(){return $(this).data("inputField").options.error}).inputField("flash",numberOfTimes)},disable:function(){this.fields.inputField("status","disable",true)},enable:function(){this.fields.inputField("status","disable",false)},get:function(){var self=this,o=self.options,formData=self._readDataFromDom();if($.isFunction(o.converter.fromForm)){formData=o.converter.fromForm(formData)}if(!formData){formData={}}return formData},clear:function(){var self=this,o=self.options;self.baseData={};self.fields.each(function(){$(this).inputField("clear")});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),"clear")})},conflicts:function(data,ignoreKeys){var self=this,formData=self._convertFormData(data),conflicts=[];if(!self.isDirty()){return}var aData=$.extend(true,{},self.baseData),bData=$.extend(true,{},formData);console.log("aData",aData);console.log("bData",bData);util.removeEqual(aData,bData,ignoreKeys);console.log("changes from base:",aData);self.fields.each(function(){var conflict=$(this).inputField("conflicts",formData);if(conflict){conflicts.push(conflict)}});self.fieldsWidgets.each(function(){var conflict=self._proxyCommandToWidget($(this),"conflicts",formData);if(conflict){if($.isArray(conflict)){conflicts.concat(conflict)}else{conflicts.push(conflict)}}});if(conflicts.length){return conflicts}else{return false}},set:function(data,setOptions){var self=this,formData=self._convertFormData(data);self.baseData=formData;self._trigger("beforeset",null,formData);self._writeDataToDom(formData,setOptions);self._trigger("afterset",null,formData)},_convertFormData:function(data){var self=this,o=self.options;var formData=$.extend(true,{},data||{});if($.isFunction(o.converter.toForm)){formData=o.converter.toForm(formData)}return formData},val:function(values){if(values===undefined){return{}}else{return this}},validate:function(){var self=this,o=self.options,valid=true;self.fields.each(function(){var el=$(this);if(el.is(":visible")&&el.inputField("validate")===false){valid=false}});self.fieldsWidgets.each(function(){var el=$(this);if(el.is(":visible")&&self._proxyCommandToWidget(el,"validate")===false){valid=false}});return valid},_destroy:function(){var self=this;self.fields.inputField("destroy");self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),"destroy")})},getFields:function(){return this.fields},_writeDataToDom:function(data,setOptions){var self=this,o=self.options;self.fields.each(function(){$(this).inputField("set",util.selectPath(data,$(this).attr("name")),setOptions)});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),"set",util.selectPath(data,$(this).attr("name")),setOptions)})},_readDataFromDom:function(){var self=this,ignoreHidden=self.options.ignoreHidden,data={};self.fields.each(function(){var el=$(this);if(ignoreHidden&&!el.is(":visible")){return}var val=el.inputField("get");if($.isArray(val)){val=val[0]}util.insertPath(data,el.attr("name"),val)});self.fieldsWidgets.each(function(){var el=$(this),ignoreHidden=self.options.ignoreHidden;if(ignoreHidden&&!el.is(":visible")){return}var val=self._proxyCommandToWidget(el,"get");util.insertPath(data,el.attr("name"),val)});return data}})})(jQuery);(function($){"use strict";var repeat=function(work,delay,count,idx){idx=idx||0;if(idx<count){work();setTimeout(function(){repeat(work,delay,count,idx+1)},delay)}};var statusNames=["require","disable","error","hover","warn","focus"];var loadDomData=function(namespace,aKey){var self=this;$.each(aKey,function(i,key){var data=self.element.data(key);if(data!==undefined&&data!==null){namespace[key]=data}})};$.widget("add123.fieldWidget",{isDirty:function(){return false},validate:function(){return true},clearDirty:function(){},clear:function(){this.set()},flash:function(){},set:function(data){},get:function(){return null}});$.widget("add123.inputField",{options:{type:"text",label:"",require:"",placeholder:"",min:"",max:""},_create:function(){var self=this,o=self.options,e=self.element;if(!e.is("input[type!=submit], select, textarea")){throw new Error("invalid element")}self.dirty=false;loadDomData.call(self,o,["require","empty","placeholder","type","label","min","max","preinput","postinput","suffix","prefix"]);if(!o.placeholder&&o.empty){o.placeholder=o.empty}var tooltip,tooltipContent=e.next();if(tooltipContent.is("div.form-input-tooltip")||tooltipContent.is("div.tooltip")){tooltip=tooltipContent}var field=self.field=$('<div class="input-field"><div class="field-items"><span class="field-item field-item-input"></span></div></div>');var layers=self.layers={items:field.find(".field-items"),input:field.find(".field-item-input")};if(o.label){self.setLabel(o.label)}e.before(field).appendTo(layers.input);field.attr("class",$.trim(field.attr("class")+" "+e.attr("class")));e.removeAttr("class");if(e.is("textarea")){field.addClass("textarea-fix");e.wrap('<div class="textarea-wrapper"></div>')}if(e.is("select")){field.addClass("select-fix")}if(!field.parents(".input-field-group").length){field.wrap('<div class="input-field-group"/>');field.find(".field-item:first").addClass("first")}if(o.placeholder){self.placeholder(o.placeholder)}if(o.preinput){self.addOn(-1,o.preinput)}if(o.postinput){self.addOn(1,o.postinput)}if(o.suffix){self.setSuffix(o.suffix)}if(o.prefix){self.setPrefix(o.prefix)}if(tooltip){var addon=self.addOn(1e3,'<span class="tooltip">?</span>',"clickable");field.addClass("has-tooltip");tooltip.popOver({target:addon,onShow:function(){addon.addClass("open")},onHide:function(){addon.removeClass("open")}}).on("click",function(){e.focus()});tooltip.popOver("hide");addon.on("click",function(){tooltip.popOver("toggle")})}layers.input.on("mousedown.inputField",function(){$("body").one("mouseup.inputField",function(){e.focus()})});self.autoValidate="blur";self.states={};self.updateStatus("require",o.require,false);e.focus(function(){self.status("focus",true)}).blur(function(ev){self.status("focus",false);self._onBlur(ev)}).change(function(ev){self._onKeyup(ev)}).on("inputfilterkeyignored.inputField",function(){self.flash()}).on("inputfilterkeytyped.inputField",function(){if(self.suffixShim){self.suffixShim.text(self.element.val())}}).on("keyup",function(ev){self._onKeyup(ev)}).on("keydown",function(ev){self._onKeydown(ev)});field.mouseenter(function(){self.status("hover",true)}).mouseleave(function(){self.status("hover",false)});self.setType(o.type);self.prevValue=e.val();if(o.max){self.setMax(o.max)}},setLabel:function(label){var self=this,field=self.field;if(!self.label){self.label=$("<label>"+label+"</label>");self.label.prependTo(field)}self.label.html(label)},setSuffix:function(t){var self=this,layers=self.layers;if(!layers.suffix){layers.suffix=$('<div class="suffix-overlay"><div class="shim"></div><span class="value">'+t+"</span></div>").prependTo(layers.items);self.suffixShim=layers.suffix.find(".shim")}else{layers.suffix.find(".value").text(t)}},setPrefix:function(t){var self=this,layers=self.layers;if(!layers.prefix){layers.prefix=$('<div class="prefix-overlay">'+t+"</div>").prependTo(layers.items)}else{self.layers.prefix.find(".value").text(t)}},setMax:function(max){var self=this,e=self.element;if(e.is(":add123-inputFilter")){e.inputFilter("setMax",max)}else{e.inputFilter({toUpper:false,max:max,pattern:/./})}},_onKeydown:function(ev){var self=this;self._showLayer("placeholder",false)},_onKeyup:function(ev){var self=this;if(self.autoValidate==="keyup"){setTimeout(function(){self.validate(true)},0)}self.checkDirty();self.redraw()},checkDirty:function(){var self=this,e=self.element,val;if(!self.dirty){val=self.get();if(!util.equals(self.prevValue,val)&&!(typeof self.prevValue==="undefined"&&val==="")){e.trigger("dirty");self.dirty=true}}else{if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}self.cleanCheckTimer=setTimeout(function(){var prev=self.prevValue,val=self.get();if(prev!==0&&(!prev||$.isEmptyObject(prev))){prev=""}if(val!==0&&(!val||$.isEmptyObject(val))){val=""}if(util.equals(prev,val)){self.dirty=false;e.trigger("clean");self.redraw()}},300)}},isDirty:function(){return this.dirty},_onBlur:function(ev){var self=this;if(self.autoValidate==="blur"){setTimeout(function(){self.validate(true)},0)}},addOn:function(weight,html,className){var self=this,layers=self.layers;if(typeof weight!=="number"){weight=0}var addon=$('<span data-weight="'+weight+'" class="field-item addon">'+html+"</span>");if(className){addon.addClass(className)}var pre=true,found=false;layers.items.children().each(function(){var el=$(this);if(el.hasClass("field-item-input")){pre=false;return}var eWeight=el.data("weight");if(typeof eWeight!=="number"){eWeight=0}if(pre&&weight<0&&weight<=eWeight){addon.insertBefore(el);found=true;layers.items.find(".field-item.first").not(":first").removeClass("first");layers.items.find(".field-item").filter(":first").addClass("first");return false}else if(!pre&&weight>=0&&weight<=eWeight){addon.insertBefore(el);found=true;return false}});if(!found&&weight<0){layers.items.find(".field-item-input").before(addon);layers.items.find(".field-item.first").not(":first").removeClass("first");layers.items.find(".field-item").filter(":first").addClass("first")}else if(!found){layers.items.append(addon)}return addon},placeholder:function(s){var self=this,layers=self.layers;if(!layers.placeholder){layers.placeholder=$('<div class="placeholder"></div>').hide().appendTo(layers.input)}layers.placeholder.text(s)},_init:function(){var self=this;self.set(self.element.attr("value"))},clear:function(){var self=this,type=self.type;self.clearDirty();if(type&&$.isFunction(type.clear)){type.clear.call(type,self)}else{self.prevValue="";self.set("")}},clearDirty:function(){var self=this;if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}self.dirty=false;self.field.removeClass("dirty");self.element.trigger("clean")},conflicts:function(value){var self=this;if(self.dirty){return{key:self.element.attr("name"),vOld:self.prevValue,vNew:value,vDirty:self.get()}}return null},set:function(value,setOptions){var self=this,e=self.element;setOptions=$.extend({autoClean:true},setOptions);if(setOptions.autoClean){self.prevValue=value;self.clearDirty()}if(self.hasStatus("error"))self.status("error",false,false);var val=self._formatToField(value);if(typeof val!=="undefined"){e.val(val)}var f=e.data("inputFilter");if(f){f._clean()}self._trigger("afterset",null,[val,value]);setTimeout(function(){self.redraw()},0)},get:function(){var self=this,e=self.element;return self._formatFromField(e.val())},value:function(value){var self=this;if(value===undefined){return self.get()}else{return self.set(value)}},isEmpty:function(){var self=this,type=self.type;if($.isFunction(type.isEmpty)){return type.isEmpty.call(type,self)}return $.trim(self.element.val())===""},validate:function(skipRequired){var self=this,states=self.states,type=self.type,empty=self.isEmpty();if(!skipRequired&&states.require&&empty){self.setError({message:"required"});return false}if(empty){self.clearError();return true}if($.isFunction(self.format)){self.format.call(self)}if($.isFunction(type.validate)){var err=type.validate.call(type,self);if(typeof err==="undefined"){self.clearError();return true}else{self.setError(err);return false}}self.clearError();return true},flash:function(numberOfTimes){var self=this,o=self.options;repeat(function(){self.field.addClass("flash");self.flashTimer=setTimeout(function(){self.field.removeClass("flash")},150)},150,numberOfTimes||1)},setError:function(err){var self=this,error=self.states.error,layers=self.layers;if(err===undefined){self.clearError();return}if(!layers.error){layers.error=$('<div class="error-overlay"></div>').appendTo(layers.input)}layers.error.text(err.message);self.status("error",true);self.autoValidate="keyup"},clearError:function(){var self=this;if(!self.states.error){return}self.autoValidate="blur";self.status("error",false)},_formatToField:function(value){var self=this,type=self.type;if(value===null||value===undefined){return value}if(!type||!type.converter||!$.isFunction(type.converter.toField)){return value}return type.converter.toField.call(type,value,self)},_formatFromField:function(value){var self=this,type=self.type;if(!type||!type.converter||!$.isFunction(type.converter.fromField)){return value}return type.converter.fromField.call(type,value,self)},redraw:function(){var self=this,e=self.element,o=self.options,hasVal=!!self.element.val(),showError=false,showNotice=true,showPlaceholder=true,layers=self.layers;if(hasVal){showPlaceholder=false}if(self.suffixShim&&!showPlaceholder){self.suffixShim.text(e.val())}if(layers.prefix){if(!showPlaceholder){if(!self.prefixPaddingAdded){self.startInputWidth=e.width();self.startPaddingLeft=e.css("padding-left").replace("[^0-9]","");self.startPaddingLeft=isNaN(self.startPaddingLeft)?5:parseInt(self.startPaddingLeft);e.css({paddingLeft:self.startPaddingLeft+layers.prefix.outerWidth()+"px",width:self.startInputWidth-layers.prefix.outerWidth()+"px"});self.prefixPaddingAdded=true}}else{e.css({paddingLeft:self.startPaddingLeft,width:self.startInputWidth+"px"});self.prefixPaddingAdded=false}}if(layers.suffix){if(!showPlaceholder){if(!self.suffixPaddingAdded){var valWidth=layers.suffix.find(".value").outerWidth();self.startInputWidth=e.width();self.startPaddingRight=e.css("padding-right").replace("[^0-9]","");self.startPaddingRight=isNaN(self.startPaddingRight)?0:parseInt(self.startPaddingRight);e.css({paddingRight:self.startPaddingRight+valWidth+"px",width:self.startInputWidth-valWidth+"px"});self.suffixShim.css({maxWidth:self.startInputWidth-valWidth+"px"});self.suffixPaddingAdded=true}}else{e.css({paddingRight:self.startPaddingRight,width:self.startInputWidth+"px"});self.suffixPaddingAdded=false}}if(self.states.error){showNotice=false;showError=true}if(self.dirty){self.field.addClass("dirty")}else{self.field.removeClass("dirty")}self._showLayer("error",showError);self._showLayer("notice",showNotice);self._showLayer("placeholder",showPlaceholder);self._showLayer("suffix",!showPlaceholder);self._showLayer("prefix",!showPlaceholder)},_showLayer:function(layer,show){var self=this,e=self.element;if(!self.layers[layer]){return}if(show){if(layer==="suffix")self.layers[layer].css("visibility","visible");else self.layers[layer].show();if(layer==="placeholder"){var ph=self.layers[layer];while(ph.outerWidth(true)>e.width()){ph.css("font-size","-=1")}}}else{if(layer==="suffix")self.layers[layer].css("visibility","hidden");else self.layers[layer].hide()}},setType:function(sType){var self=this,types=$.add123.inputField.types,type=self.type;if(type&&$.isFunction(type.tearDown)){type.tearDown().call(type,self)}if(!sType||!types[sType]){sType="text"}type=Object.create(types[sType]);if($.isFunction(type.setUp)){type.setUp.call(type,self)}self.type=type},getType:function(){return this.type},hide:function(){this.field.hide()},show:function(displayValue){if(displayValue){this.field.css("display",displayValue)}else{this.field.show()}},getField:function(){return this.field},enable:function(){this.status("disable",false)},disable:function(){this.status("disable",true)},isDisabled:function(){return this.hasStatus("disable")},status:function(statusName,bool,fireEvents){var self=this,o=self.options;if($.inArray(statusName,statusNames)<0){return}var cleanBool=!!bool,states=self.states;if(cleanBool===states[statusName]){return}states[statusName]=cleanBool;self.redraw();if(states[statusName]){self.field.addClass(statusName)}else{self.field.removeClass(statusName)}var layers=self.layers;if(statusName==="disable"){if(!layers.disable){layers.disable=$('<div class="disable-overlay"></div>').appendTo(layers.items)}if(cleanBool){setTimeout(function(){layers.disable.css({width:layers.items.outerWidth()-2+"px",height:layers.items.outerHeight()-2+"px"}).show()},0)}else{layers.disable.hide()}}if(fireEvents!==false){self._trigger("statusUpdate",null,{statusName:statusName,value:states[statusName]})}},updateStatus:function(statusName,bool,fireEvents){this.status(statusName,bool,fireEvents)},hasStatus:function(statusName){return!!this.states[statusName]},_destroy:function(){var self=this;if(self.type&&self.type.tearDown){self.type.tearDown.call(self.type,self)}}});$.add123.inputField.types={setUp:function(ui){},tearDown:function(ui){},converter:{toField:function(value,ui){return value},fromField:function(value,ui){return value}},validate:function(ui){return{message:"Demo Error"}}}})(jQuery);(function($){$.widget("add123.inputFilter",{options:{toUpper:false,max:0,pattern:/[\w\s]/},_create:function(){var self=this,e=self.element,memory;self.nativeChange=false;if(!e.is("input[type=text], textarea")){throw new Error("inputFilter must be applied to a text input ")}e.on("keydown.inputFilter",$.proxy(this._onKeyDown,self));e.on("keypress.inputFilter",$.proxy(this._onKeyPress,self));e.on("paste.inputFilter",$.proxy(this._onPaste,self));e.on("focus.inputFilter",function(){memory=e.val()});e.on("blur.inputFilter",function(){if(!self.nativeChange&&memory!==e.val()){e.change()}self.nativeChange=false})},setMax:function(max){this.options.max=max},setPattern:function(regex){this.options.pattern=regex},_onPaste:function(ev){setTimeout($.proxy(this._clean,this),0)},_onKeyDown:function(ev){if(ev.which<32||ev.which>126||ev.ctrlKey){this.nativeChange=true}},_onKeyPress:function(ev){var self=this;if(ev.which<32||ev.which>126||ev.ctrlKey){return true}self._type(String.fromCharCode(ev.which));return false},_clean:function(){var v=this.element.val();this.element.val("");$.each(v.split(""),$.proxy(function(i,c){this._type(c)},this))},_type:function(text){var self=this,o=self.options,e=self.element,val=e.val(),keytypedEvent="keytyped",keyignoredEvent="keyignored",p,tmp;if(o.toUpper){text=text.toUpperCase()}if(text.match(o.pattern)){if(e.is(":focus")){p=e.caret();tmp=val.slice(0,p.begin)+text+val.slice(p.end);if(o.max&&tmp.length>o.max){self._trigger(keyignoredEvent);return false}else{e.val(tmp);e.caret(p.begin+text.length)}}else{p=val+text;if(o.max&&p.length>o.max){p=p.substring(0,o.max);self._trigger(keyignoredEvent);return false}e.val(p)}self._trigger(keytypedEvent);return true}else{self._trigger(keyignoredEvent);return false}},_destroy:function(){var self=this,e=self.element;e.off(".inputFilter")}})})(jQuery);(function($){var doc=$(document),win=$(window),body=$("body");$.widget("add123.popOver",{options:{target:"",top:0,left:0,appendTo:"body"},_create:function(){var self=this,o=self.options,e=self.element;self.showing=false;e.detach();var content=e.clone().addClass("form-input-tooltip");self.title=$('<h3 class="tooltip-title"></h3>');e.addClass("tooltip-wrapper").css("position","absolute");e.empty();e.append(self.title).append(content);e.appendTo(o.appendTo);self.onClick=function(ev){var target=$(ev.target);if(!self.showing){return}if(!target.childOf(e,true)&&!$(ev.delegateTarget.activeElement).childOf(e,true)&&!target.childOf(o.target,true)){if(self._trigger("beforeoffclick",ev,target)){self.hide()}}};self.onResize=function(ev){if(!self.showing){return}self.position()};doc.on("mousedown",self.onClick);win.on("resize",self.onResize)},setAppendTo:function(el){var self=this,o=self.options,e=self.element;o.appendTo=el;e.appendTo(el)},_init:function(){var self=this,e=self.element,titleElement=self.title;var title=e.attr("title");if(title){titleElement.text(title).show()}else{titleElement.hide()}},toggle:function(){var self=this,e=self.element;if(self.showing){self.hide()}else{self.show()}},show:function(){var self=this;if(self.showing){return}setTimeout(function(){self.showing=true;self.position();self.element.fadeIn(10);self._trigger("onShow")},0)},hide:function(){var self=this;if(!self.showing){return}self.showing=false;self.element.hide();self._trigger("onHide")},position:function(){var self=this,o=self.options,e=self.element,my="left+"+(o.left-3)+" top+"+(o.top+3),at="left bottom",collision="flipfit none";if(o.my){my=o.my}if(o.at){at=o.at}if(o.collision){collision=o.collision}setTimeout(function(){e.position({my:my,at:at,of:o.target,collision:collision})},0)},_destroy:function(){var self=this,e=self.element;doc.off("mousedown",self.onClick);win.off("resize",self.onResize)}})})(jQuery);(function($){$.widget("add123.submitButton",{options:{color:"#000",delay:10,disabled:false,waiting:false,preventDefault:true,enterKeyListenerProvider:function(){return this.parents("form").first()},onKeyDown:function(ev){if(ev.keyCode===13&&!$(ev.target).is("textarea")){this.submit.call(this,ev)}}},_showLoading:function(){var self=this,e=self.element,o=self.options,w=e.width(),h=e.height();e.addClass("submitting");self.getButtonLabel().css("visibility","hidden");self.spinner.appendTo(e).spin({color:o.color,top:-h+4,left:-7})},getButtonLabel:function(){return this.element.find(".ui-button-text")},_hideLoading:function(){var self=this,e=self.element;if(self.destroyed){return}e.removeClass("submitting");self.spinner.spin("stop");self.getButtonLabel().css("visibility","visible")},_create:function(){var self=this;var o=self.options;var e=self.element,bOptions={};if(o.icons){bOptions.icons=o.icons}if(o.disabled){bOptions.disabled=o.disabled}if(o.text!==undefined){bOptions.text=o.text}o.label=e.html();e.button(bOptions).on("click.submitButton",$.proxy(self.submit,self));self.spinner=$('<div class="spinner" style="display: inline-block; position: absolute;"></div>');e.append(this.spinner);var listenerProvider=o.enterKeyListenerProvider;if($.isFunction(listenerProvider)){var listener=listenerProvider.call(e);if(typeof listener!=="undefined"){listener.on("keydown.submitButton",$.proxy(o.onKeyDown,self))}}},submit:function(ev){var self=this;var o=self.options;if(o.preventDefault&&ev)ev.preventDefault();if(o.waiting===true||o.disabled===true)return this;if(!ev)ev=null;if(self._trigger("beforesubmit",ev)===false)return this;o.waiting=true;self._showLoading.call(self);setTimeout(function(){self._trigger("submit",ev,function(){o.waiting=false;self._hideLoading.call(self);self._trigger("aftersubmit",ev)})},o.delay);return this},enable:function(){this.options.disabled=false},disable:function(){this.options.disabled=true},_destroy:function(){var self=this,e=self.element;e.off(".submitButton");self.destroyed=true}})})(jQuery);(function($){var binarySearch=function(needle,haystack){var mid,element;if(!haystack.length){return-1}var high=haystack.length-1;var low=0;needle=needle.toLowerCase();while(low<=high){mid=parseInt((low+high)/2,10);element=haystack[mid].value.toLowerCase();if(element>needle){high=mid-1}else if(element<needle){low=mid+1}else{return mid}}return-1};var codeListFilter=function(codeTable){return function(request,response){if(request.term.length<3){response();return}var matcher=new RegExp($.ui.autocomplete.escapeRegex(request.term),"i");var matches=$.grep(codeTable,function(value){return matcher.test(value.label)||matcher.test(value.value)});response(matches)}};$.add123.inputField.types.code={setUp:function(ui){var e=ui.element,o=ui.options;var codeTableName=e.data("codes");if(!codeTableName){throw new Error("not data-codes attribute given for input "+e.attr("name"))}o._codeTable=window[codeTableName];if(!o._codeTable){throw new Error("ERROR: data-codes points to an undefined window property window["+codeTableName+"] for input [name="+e.attr("name")+"]")}e.autocomplete({source:codeListFilter(o._codeTable)}).on("autocompleteselect.type-code",function(ev,ui){}).on("keyup.type-code",function(ev){})},tearDown:function(ui){var o=ui.options,e=ui.element;e.html("").off(".type-code").autocomplete("destroy");delete o.codeTable},validate:function(ui){var e=ui.element;if(binarySearch(e.val(),ui.options._codeTable)<0){return{message:"invalid"}}}}})(jQuery);(function($){var doc=$(document);$.add123.inputField.types.select={setUp:function(inputWidget){var self=this,o=inputWidget.options,e=inputWidget.element;self.element=e;self.source=[];self.inputWidget=inputWidget;var fieldGroup=self.fieldGroup=inputWidget.field.parents(".input-field-group");if(e.is("select")){
console.log("** ERROR: deprecated use of <select> in the select type **")}e.css("opacity",0);var shim=self.shim=$('<div class="shim" style="width:100%;height:100%;position:absolute;top:0;left:0;"><div style="padding:0 25px 0 6px;overflow:hidden;"><div style="overflow:hidden;"></div></div></div>').insertAfter(e);inputWidget.field.addClass("select-box");self.iconClosed=$('<span class="tms-icon tms-icon-sort-down dropdown-closed-icon"></span>').insertAfter(e);self.iconOpen=$('<span class="tms-icon tms-icon-sort-up dropdown-open-icon"></span>').insertAfter(e).hide();var panel=self.panel=$('<div class="dropdown-panel"><div class="tms-select-dropdown-content"><div class="search"/><div class="options" style="position:relative;"/></div></div>').hide();self.options=panel.find(".options");inputWidget.layers.items.append(panel).css("position","relative");var selectionClass=self.sectionClass="selected";panel.on("click",".option",function(){self._setSelected()}).on("mouseenter",".option",function(){panel.find("."+selectionClass).removeClass(selectionClass);$(this).addClass(selectionClass)}).on("mouseleave",".option",function(){$(this).removeClass(selectionClass)});inputWidget.layers.items.on("click",function(ev){if(inputWidget.states.disable){return}var target=$(ev.target);if(target.childOf(panel,true)){return}setTimeout(function(){self.toggle()},0)});var filter=self.filter=$('<input type="text" class="filter-box" style="width:100%;position:relative;" />').appendTo(panel.find(".search")).inputField();filter.after('<span class="tms-icon tms-icon-search" style="position:absolute;right: 7px;top: 1px; font-size: 15px; cursor: default;"></span>');filter.parents(".field-item").first().addClass("first");filter.parent().css("display","block").parent().css("display","block").parent().css("display","block");filter.on("click",function(ev){ev.preventDefault();ev.stopPropagation();return false});e.on("keydown",$.proxy(self._keyDownNavigate,self));filter.on("keydown",$.proxy(self._keyDownNavigate,self));filter.on("keyup",$.proxy(self._onKeyup,self));filter.on("dirty clean",function(ev){ev.preventDefault();ev.stopPropagation()});self.closeListener=function(ev){var which=ev.which;if(which===27||which===13){ev.preventDefault();ev.stopPropagation();if(which===13){self._setSelected()}else{self.element.focus()}setTimeout(function(){self.close()},0);return}var target=$(ev.target);if(!target.childOf(panel,true)&&!target.childOf(fieldGroup,true)){setTimeout(function(){self.close()},0)}};self.update()},_keyDownNavigate:function(ev){var self=this,panel=self.panel,selectionClass=self.sectionClass,which=ev.which;if(which===9){self.element.next("input").focus();return}if(which===27||which===13){ev.preventDefault();return}var selected,next;if(which===40){selected=panel.find("."+selectionClass);if(!selected.length){panel.find(".option:first").addClass(selectionClass)}else{next=selected.next();if(next.length){next.addClass(selectionClass);selected.removeClass(selectionClass)}}self._scroll()}if(which===38){selected=panel.find("."+selectionClass);if(!selected.length){panel.find(".option:last").addClass(selectionClass)}else{next=selected.prev();if(next.length){next.addClass(selectionClass);selected.removeClass(selectionClass)}}self._scroll()}if(which<32||which>126){return}self.open()},_onKeyup:function(ev){var self=this,filter=self.filter,which=ev.which,val=filter.val();if(self.filterValue===val){return}self.filterValue=val;self._filterOptions()},_setSelected:function(){var self=this,e=self.element,selected=self.panel.find(".selected:not(.filtered):visible");if(!selected.length){self._selectFirstNonEmptyOption()}selected=self.panel.find(".selected:not(.filtered):visible");var item=self.item=selected.data("item");if(!item){return}self._setLabel(self.renderLabel(item));self.close();e.val(self.item.value);e.focus();e.change();self.inputWidget.redraw();self.showHideCommand()},_selectFirstNonEmptyOption:function(){var self=this;self._removeSelection();self.panel.find(".option:not(.filtered):visible").each(function(){var option=$(this);if(option.html()){option.addClass("selected");return false}})},_set:function(val){var self=this;self.filter.val("");self.filterValue="";self.item=undefined;self.loaded.done(function(){self._removeSelection();var options=self.panel.find(".option");options.each(function(){var item=$(this),itemData=item.data("item");if(self._equal(itemData,val)){item.addClass("selected");self.item=itemData;self._setLabel(itemData.label);self.showHideCommand();return false}});if(!self.item||!self.item.value){if(self.inputWidget._trigger("itemnotfound",null,[val])){self._handleItemNotFound()}}})},_removeSelection:function(){this.panel.find(".option").removeClass("selected")},_handleItemNotFound:function(){var self=this,e=self.element;self._setDefaultItem();if(!self.item||!self.item.value){self._selectFirstItem()}},_setDefaultItem:function(){var self=this,e=self.element,options=self.panel.find(".option"),defaultValue={value:e.attr("data-default")};options.each(function(){var item=$(this),itemData=item.data("item");if(self._equal(itemData,defaultValue)){if(e.attr("name")==="params.category"){console.log("found defaultValue",defaultValue,itemData)}item.addClass("selected");self.item=itemData;self._setLabel(itemData.label);self.showHideCommand();return false}})},_selectFirstItem:function(){var self=this,e=self.element,options=self.panel.find(".option");self.item=options.first().addClass("selected").data("item");if(self.item&&self.item.label){self._setLabel(self.item.label)}else{self._setLabel("")}self.showHideCommand()},showHideCommand:function(){var self=this,showClass=self.item&&self.item.showClass,sections=self.showHideSections;if(!sections){return}sections.hide();if(!showClass){return}sections.filter("."+showClass).show()},clear:function(){var self=this,e=self.element;self.item={};self.panel.find(".selected").removeClass("selected");e.val("");self.filter.val("");self.filterValue="";self._handleItemNotFound();self.inputWidget.redraw()},_equal:function(a,b){return a&&b&&a.value===b.value},_setLabel:function(text){this.shim.children().children().text(text)},_getLabel:function(){return this.shim.children().children().text()},toggle:function(){var self=this;if(self.panel.is(":visible")){self.close()}else{self.open()}},getOptions:function(){var self=this,optionPanel=self.panel.find(".option"),options=[];optionPanel.each(function(){options.push($(this).data("item"))});return options},_filterOptions:function(){var self=this;self._removeSelection();self.panel.addClass("filtering");if(self.filterTimer){clearTimeout(self.filterTimer)}self.filterTimer=setTimeout(function(){self.__filterOptionsWork()},200)},__filterOptionsWork:function(optionsElements){var self=this,val=self.filterValue;self.panel.addClass("filtering");if(!optionsElements){optionsElements=self.panel.find(".option")}if(!optionsElements.length){self.panel.removeClass("filtering");self.inputWidget._trigger("filterdone");return}var optionsToProcessNow=optionsElements.splice(0,1e3);$.each(optionsToProcessNow,function(i,optionsEl){self._filterItem($(optionsEl),val)});setTimeout(function(){self.__filterOptionsWork(optionsElements)},0)},_filterItem:function(optionEl,val){var self=this,item=optionEl.data("item");if(self._itemShoudBeFiltered(item,val)){optionEl.addClass("filtered")}else{optionEl.removeClass("filtered")}},_itemShoudBeFiltered:function(item,val){if(!val){return false}if(!item.label){return true}return item.label.match(new RegExp($.ui.autocomplete.escapeRegex(val),"i"))===null},_clearFilter:function(){var self=this;self.filter.val("");self.panel.find(".option.filtered").removeClass("filtered")},_buildEmptyOption:function(){var self=this,e=self.element,emptyLabel=e.data("emptyLabel");if(emptyLabel!==""&&!emptyLabel){return}self.source.unshift({label:emptyLabel,value:""})},_buildOptions:function(){var self=this,e=self.element,panel=self.panel,options=self.options;self.element.trigger("tmsselectbeforebuild");options.empty();var optionsbuffer=$("<div/>");if(!e.data("noSort")){self._sort(self.source)}self._buildEmptyOption();$.each(self.source,function(i,item){var option=$('<div class="option"/>'),renderedItem=self.renderItem(item);if(renderedItem!==null){option.append(renderedItem).data("item",item);optionsbuffer.append(option)}if(renderedItem===""){option.height(20)}});options.append(optionsbuffer);self.element.trigger("tmsselectafterbuild",[options])},_sort:function(items){items.sort(function(a,b){if(!a||!b){return}var al=a.label.toLowerCase(),bl=b.label.toLowerCase();return al>bl?1:al<bl?-1:a.label>b.label?1:a.label<b.label?-1:0})},_scroll:function(){var self=this,options=self.options;if(!self.panel.is(":visible")){return}setTimeout(function(){var selected=self.panel.find(".selected"),top;if(selected.length===0){top=0}else{top=selected.position().top}options.scrollTop(top+selected.height())},0)},open:function(){var self=this,e=self.element,panel=self.panel,inputLayer=self.inputWidget.layers.input,itemsLayer=self.inputWidget.layers.items;if(panel.is(":visible")){return}self.filterValue="";doc.on("click keyup",self.closeListener);var leftOffset=0;if(inputLayer.index()){leftOffset=inputLayer.position().left-1}panel.width(e.width()).css({left:leftOffset,top:itemsLayer.height()-1+"px",width:e.outerWidth()+"px"}).hide();self.iconClosed.hide();self.iconOpen.show();panel.show();self.filter.focus();self._scroll()},renderLabel:function(item){return item&&item.label||""},renderItem:function(item){return item.label},close:function(){var self=this,panel=self.panel,filter=self.filter;doc.off("click keyup",self.closeListener);panel.hide();self._clearFilter();self.iconClosed.show();self.iconOpen.hide()},update:function(){var self=this,e=self.element;self.loaded=$.Deferred();self.load().done(function(source){if(!source){source=[]}self.source=source;setTimeout(function(){self.removeInvalid()},0);self._buildOptions();if(self.filter&&self.filter.data("inputField")){if(source.length<5){self.filter.inputField("hide")}else{self.filter.inputField("show")}}var form,sections=$([]);$.each(source,function(i,item){if(item.showClass){if(!form){form=e.parents(":add123-formBuilder").first()}sections=sections.add(form.find("."+item.showClass))}});self.showHideSections=sections;self.loaded.resolve();self.showHideCommand()});return self.loaded},removeInvalid:function(ev,ui){var self=this,e=self.element,val=e.val(),source=self.source,l=source.length,i;if(ui&&ui.item){return}for(i=0;i<l;i++){if(source[i].label===val&&self.item&&self.item.id===source[i].id){self.item=source[i];return}}e.val("")},load:function(){var self=this,e=self.element,source=[],dataOptions=e.attr("data-options");if(dataOptions){source=$.parseJSON(dataOptions)}else{e.find("option").each(function(){var option=$(this);source.push({label:option.text(),value:option.val()})})}return $.when(source)},map:function(raw){return{label:raw,value:raw}},deMap:function(obj){if(!obj){return null}return obj.value||null},isEmpty:function(){var self=this,data=self.deMap(self.item);return data!==0&&!data},converter:{fromField:function(){var self=this,data=self.item;if(data===undefined){return null}var val=self.deMap(data);if(val===undefined){return null}return val},toField:function(rawdata){var self=this,e=self.element,data=self.map(rawdata);if(!rawdata&&typeof e.data("default")!=="undefined"){data=self.map(e.data("default"))}if(!data){self.clear();return}self._set(data);return data.label}}}})(jQuery);(function($){"use strict";var doc=$(document);var types=$.add123.inputField.types;types.text={};var cannedFormatters={trim:function(ui){var e=ui.element;e.val($.trim(e.val()))}};var createRegexType=function(pattern,filter,flags,max){if(flags===undefined){flags={}}if(flags.toUpper!==false){flags.toUpper=true}var type={validate:function(ui){if(!ui.element.val().match(pattern)){return{message:"invalid"}}}};if(filter||max){type.setUp=function(ui){var filterData={pattern:filter||/./,toUpper:flags.toUpper,max:max||0};if(ui.element.attr("data-max")){filterData.max=ui.element.attr("data-max")}ui.element.inputFilter(filterData)}}if(flags.cannedFormatter!==undefined){if($.isFunction(cannedFormatters[flags.cannedFormatter])){type.format=cannedFormatters[flags.cannedFormatter];type.converter={toField:function(val,ui){return type.format(ui)},fromField:function(val,ui){return type.format(ui)}}}}return type};$.add123.inputField.createRegexType=createRegexType;$.extend(types,{utext:createRegexType(/.*/,/.*/,{toUpper:true}),integer:createRegexType(/^[0-9]*$/,/[0-9]/),number:createRegexType(/^-?[0-9]+\.?[0-9]*$/,/[-0-9.]/),state:createRegexType(/^[A-Z]{2}$/,/[A-Z]/,{},2),feid:createRegexType(/^[0-9]{2}\-?[0-9]{7}$/,/[0-9\-]/,{},10),zip:createRegexType(/(^\d{5}(\-?\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Za]{1}\d{1})$/,/[0-9A-Z\s\-]/,{},10),email:createRegexType(/^(?!.*\.{2})[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,4}$/,/[A-Za-z0-9._%+\-@]/,{toUpper:false,cannedFormatter:"trim"})});types.display={setUp:function(ui){var e=ui.element;e.parents(".field-item").hide();e.parents(".field-items").append('<div class="input-display"></div>')},converter:{toField:function(val,ui){ui.element.parents(".field-items").find(".input-display").html(val)},fromField:function(value,ui){return ui.element.parents(".field-items").find(".input-display").html().trim()}}};types.phone={setUp:function(ui){var self=this,e=ui.element;e.inputFilter({pattern:/[0-9()\s\-x]/});e.on("blur",function(){e.val(self.format(e.val()))})},converter:{toField:function(val,ui){return this.format(val)},fromField:function(val,ui){return this.format(val)}},format:function(text){if(!text){return""}var extensionStart=0,xlocation=text.indexOf("x"),lastSpace=text.lastIndexOf(" "),ext="",extraExt="";if(xlocation>0){extensionStart=xlocation}else if(lastSpace>7){extensionStart=lastSpace}if(extensionStart>0){ext=text.substring(extensionStart+1);text=text.substring(0,extensionStart)}var num=$.trim(text.replace(/[()\s\-]/g,"")),numberLength=num.length;if(num[0]==="1"){num=num.substring(1);numberLength--}if(numberLength>10){extraExt=num.substring(10);num=num.substring(0,10);numberLength=10}if(numberLength===7){num=num.substring(0,3)+"-"+num.substring(3)}else if(numberLength===10){num=num.substring(0,3)+"-"+num.substring(3,6)+"-"+num.substring(6)}ext=extraExt+ext;num=num.replace(/[^0-9^x^-]/g,"");ext=ext.replace(/[^0-9^x^-]/g,"");if(ext){num+="x"+ext}return num},validate:function(ui){if(!ui.element.val().match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)){return{message:"invalid"}}}};types.money={setUp:function(ui){var self=this,e=ui.element;self.element=e;e.inputFilter({pattern:/[0-9\.]/}).change(function(){self._onChange()}).blur(function(){e.val(self.format(e.val()))});if(!e.data("currency-symbol")){ui.addOn(-100,"$")}else{ui.addOn(-100,e.data("currency-symbol"))}},_onChange:function(){var self=this,e=self.element,caret=e.caret();e.val(self.format(e.val())).caret(caret.begin,caret.end)},format:function(money){if($.trim(money)===""){return""}try{if(isNaN(money)){money=money.toString();var count=0;for(var i=0;i<money.length;i++){if(money[i]==="."){count++}}var dec=money.indexOf(".");if(dec!=-1){money=money.replace(/\./g,"");money=money.substring(0,dec)+"."+money.substring(dec)}money=parseFloat(money)}return(+money).toFixed(2)}catch(err){return""}},converter:{toField:function(val,ui){return this.format(val)},fromField:function(val,ui){if($.trim(val)===""){return""}return+this.format(val)}}}})(jQuery);(function($){var types=$.add123.inputField.types;types.date={attributes:["minyear","maxyear","startdate","enddate"],setUp:function(ui){var self=this,e=ui.element,tmp;ui.placeholder("MM/DD/YYYY");var minYear=(new Date).getFullYear()-15,maxYear=(new Date).getFullYear()+2;tmp=e.data("minyear");if(tmp!==undefined){if(tmp==="CURRENT"){minYear=(new Date).getFullYear()}else{minYear=tmp}}tmp=e.data("maxyear");if(tmp!==undefined){if(tmp==="CURRENT"){maxYear=(new Date).getFullYear()}else{maxYear=tmp}}var startDate="1/1/"+minYear,endDate="12/31/"+maxYear;tmp=e.data("startdate");if(tmp!==undefined){if(tmp==="TODAY"){startDate=(new moment).format("MM/DD/YYYY")}else if(tmp.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){startDate=tmp}}tmp=e.data("enddate");if(tmp!==undefined){if(tmp==="TODAY"){endDate=(new moment).format("MM/DD/YYYY")}else if(tmp.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){endDate=tmp}}var datePickerOptions={startDate:startDate,endDate:endDate,autoclose:true,forceParse:false,format:"mm/dd/yyyy",todayBtn:true,todayHighlight:true,language:util.lang.code};e.datepicker(datePickerOptions);e.inputFilter({pattern:/[0-9\/]/,max:10,toUpper:true})},converter:{toField:function(val,ui){if(!val||!val.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)){return""}return val.substring(5,7)+"/"+val.substring(8,10)+"/"+val.substring(0,4)},fromField:function(val,ui){if(!val||!val.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){return""}return val.substring(6,10)+"-"+val.substring(0,2)+"-"+val.substring(3,5)}},tearDown:function(ui){ui.element.datepicker("remove")},validate:function(ui){var self=this,date=ui.element.val();if(!moment(date,["MM/DD/YYYY"],true).isValid()){return{message:"invalid"}}}};types.time={attributes:["step"],_regex:/^((0[0-9])|([0-9])|(1[0-2])):([0-5][0-9])((am)|(pm))$/,setUp:function(ifw){var self=this,e=ifw.element;ifw.placeholder("H:MMam/pm");e.inputFilter({pattern:/[0-9:apm]/,max:7});e.timepicker({appendTo:e.parent(),selectOnBlur:false,step:e.data("step")});e.on("showTimepicker",function(){e.siblings(".ui-timepicker-wrapper").width(e.outerWidth())})},converter:{toField:function(val,ifw){var self=this;if(!val||!val.match(/^[0-9]{2}:[0-9]{2}$/))return"";return moment.utc(val,"HH:mm",true).local().format("h:mma")},fromField:function(val,ifw){var self=this;if(!val||!val.match(self._regex))return"";return moment(val,"h:mma").utc().format("HH:mm")}},tearDown:function(ifw){ifw.element.timepicker("remove")},validate:function(ifw){var self=this,e=ifw.element,val=e.val(),invalidMessage={message:"invalid"};if(!val.match(self._regex))return invalidMessage}};types.dateTime={setUp:function(inputFieldWidgetInstance){var self=this;self.ifw=inputFieldWidgetInstance;self._setUpFields();self._refreshFieldWidth();self._setUpCleanDirtyEvents();self.ifw.element.on("resize",function(ev){self._refreshFieldWidth()})},_setUpFields:function(){var self=this,e=self.ifw.element,fieldItems=self.ifw.element.parent().parent(),dateAttr="",timeAttr="",options,tmp,i;self.ifw.element.parent().hide();for(i=0;i<types.date.attributes.length;++i){tmp=e.data(types.date.attributes[i]);if(tmp!==undefined){dateAttr+="data-"+types.date.attributes[i]+'="'+tmp+'" '}}for(i=0;i<types.time.attributes.length;++i){tmp=e.data(types.time.attributes[i]);if(tmp!==undefined){timeAttr+="data-"+types.time.attributes[i]+'="'+tmp+'" '}}options={require:true};self.dateWidget=$('<input type="text" data-type="date" '+dateAttr+"/>").prependTo(fieldItems).inputField(options);self.timeWidget=$('<input type="text" data-type="time" '+timeAttr+"/>").appendTo(fieldItems).inputField(options)},_refreshFieldWidth:function(){var self=this,fullWidth=self.ifw.element.outerWidth(),elDate=self.dateWidget,elTime=self.timeWidget,timeWidthRatio,minWidth;fullWidth-=elDate.outerWidth()-elDate.width();fullWidth-=elTime.outerWidth()-elTime.width();minWidth=self.ifw.element.css("min-width");if(minWidth!==null){minWidth=parseInt(minWidth,10)}if(minWidth===null||minWidth<100){minWidth=270}if(fullWidth<minWidth){fullWidth=minWidth}timeWidthRatio=self.ifw.element.data("timeWidthRatio");if(isNaN(timeWidthRatio)||timeWidthRatio<.2||.8<timeWidthRatio){timeWidthRatio=.5}elTime.width(fullWidth*timeWidthRatio);elDate.width(fullWidth-elTime.width())},_setUpCleanDirtyEvents:function(){var self=this;self.dateWidget.on("dirty clean",function(ev){ev.stopPropagation();self.ifw.checkDirty()});self.timeWidget.on("dirty clean",function(ev){ev.stopPropagation();self.ifw.checkDirty()})},converter:{toField:function(val,ifw){var self=this,splitDate=self._splitDateAndTime(val);self.timeWidget.inputField("set",splitDate.time);self.dateWidget.inputField("set",splitDate.date);setTimeout(function(){self.timeWidget.inputField("redraw");self.dateWidget.inputField("redraw")},0)},fromField:function(val,ifw){var self=this,dateTimeObject;dateTimeObject={date:self.dateWidget.inputField("get"),time:self.timeWidget.inputField("get")};return self._joinDateAndTime(dateTimeObject)}},_momentDateFormat:"YYYY-MM-DDTHH:mm:ss[Z]",_splitDateAndTime:function(dateTimeString){var dateString,timeString;var dateTime=moment(dateTimeString,self._momentDateFormat,true);if(!dateTime.isValid()){return{date:"",time:""}}return{date:dateTime.format("YYYY-MM-DD"),time:dateTime.utc().format("HH:mm")}},_joinDateAndTime:function(dateTimeObject){var dto=dateTimeObject;if(dto.date===""||dto.time==="")return"";return dto.date+"T"+dto.time+":00Z"},validate:function(ifw){var self=this,valid=true,skipRequired=!self.ifw.hasStatus("require");if(skipRequired){skipRequired=!self.dateWidget.inputField("isEmpty");skipRequired=skipRequired&&!self.timeWidget.inputField("isEmpty")}valid=valid&&self.dateWidget.inputField("validate",skipRequired);valid=valid&&self.timeWidget.inputField("validate",skipRequired);if(!valid){return{message:"invalid"}}},isEmpty:function(){var self=this;return $.trim(self.dateWidget.val())+$.trim(self.timeWidget.val())===""},tearDown:function(ifw){self.dateWidget.remove();self.timeWidget.remove();self.dateWidget=undefined;self.timeWidget=undefined;ifw.parent().show()}}})(jQuery);
//# sourceMappingURL=jquery.formBuilder.min.js.map